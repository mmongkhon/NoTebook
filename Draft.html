<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
h1
	{margin-top:20.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:20.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h2
	{margin-top:.25in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h3
	{margin-top:16.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Arial",sans-serif;
	color:#434343;
	font-weight:normal;}
h4
	{margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;
	color:#666666;
	font-weight:normal;}
h5
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	color:#666666;
	font-weight:normal;}
h6
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	color:#666666;
	font-weight:normal;
	font-style:italic;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:26.0pt;
	font-family:"Arial",sans-serif;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:16.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:15.0pt;
	font-family:"Arial",sans-serif;
	color:#666666;}
.MsoChpDefault
	{font-family:"Arial",sans-serif;}
.MsoPapDefault
	{line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=EN-US style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal><span lang=EN>&lt;!DOCTYPE html&gt;</span></p>

<p class=MsoNormal><span lang=EN>&lt;html lang=&quot;th&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>&lt;head&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;meta name=&quot;viewport&quot;
content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>   
&lt;title&gt;NoTeBooK - เว็บไซต์ส่วนตัว&lt;/title&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;script
src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;link
href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css&quot;
rel=&quot;stylesheet&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;style&gt;</span></p>

<p class=MsoNormal><span lang=EN>        @import
url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&amp;display=swap');</span></p>

<p class=MsoNormal><span lang=EN>        body { font-family: 'Kanit',
sans-serif; }</span></p>

<p class=MsoNormal><span lang=EN>        .sticky-header { position: sticky;
top: 0; z-index: 50; }</span></p>

<p class=MsoNormal><span lang=EN>        .fade-in { animation: fadeIn 0.5s
ease-in; }</span></p>

<p class=MsoNormal><span lang=EN>        @keyframes fadeIn { from { opacity: 0;
} to { opacity: 1; } }</span></p>

<p class=MsoNormal><span lang=EN>        .slide-up { animation: slideUp 0.3s
ease-out; }</span></p>

<p class=MsoNormal><span lang=EN>        @keyframes slideUp { from { transform:
translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }</span></p>

<p class=MsoNormal><span lang=EN>        .notification { position: fixed; top:
20px; right: 20px; z-index: 100; }</span></p>

<p class=MsoNormal><span lang=EN>        .hero-gradient { background:
linear-gradient(135deg, #667eea 0%, #764ba2 100%); }</span></p>

<p class=MsoNormal><span lang=EN>        .card-hover { transition: all 0.3s
ease; }</span></p>

<p class=MsoNormal><span lang=EN>        .card-hover:hover { transform:
translateY(-5px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }</span></p>

<p class=MsoNormal><span lang=EN>        .line-clamp-2 { display: -webkit-box;
-webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }</span></p>

<p class=MsoNormal><span lang=EN>        .line-clamp-3 { display: -webkit-box;
-webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/style&gt;</span></p>

<p class=MsoNormal><span lang=EN>&lt;/head&gt;</span></p>

<p class=MsoNormal><span lang=EN>&lt;body class=&quot;bg-gray-50&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;!-- Header --&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;header class=&quot;sticky-header
bg-white shadow-lg border-b-2 border-purple-500&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div class=&quot;container mx-auto
px-4 py-3&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;flex
items-center justify-between&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;text-2xl
font-bold text-purple-600 cursor-pointer&quot;
onclick=&quot;showHome()&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;i class=&quot;fas
fa-book-open mr-2&quot;&gt;&lt;/i&gt;NoTeBooK</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;!-- Mobile Menu Button
--&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
id=&quot;mobileMenuBtn&quot; class=&quot;md:hidden text-gray-700
hover:text-purple-600 transition-colors&quot;
onclick=&quot;toggleMobileMenu()&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;i class=&quot;fas
fa-bars text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                </span></p>

<p class=MsoNormal><span lang=EN>                &lt;!-- Desktop Navigation
--&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;nav class=&quot;hidden
md:flex items-center space-x-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;a href=&quot;#&quot;
onclick=&quot;showHome()&quot; class=&quot;flex items-center text-gray-700
hover:text-purple-600 transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-home mr-2&quot;&gt;&lt;/i&gt;หน้าแรก</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/a&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;a href=&quot;#&quot;
onclick=&quot;showNotebooks()&quot; class=&quot;flex items-center text-gray-700
hover:text-purple-600 transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-book mr-2&quot;&gt;&lt;/i&gt;สมุดโน้ต</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/a&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;a href=&quot;#&quot;
onclick=&quot;showFeedback()&quot; class=&quot;flex items-center text-gray-700
hover:text-purple-600 transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-comment mr-2&quot;&gt;&lt;/i&gt;ส่งข้อเสนอแนะ</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/a&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/nav&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;flex
items-center space-x-3&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
id=&quot;userActions&quot; class=&quot;hidden items-center space-x-3&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;button
onclick=&quot;showMessages()&quot; class=&quot;relative p-2 text-gray-600 hover:text-purple-600
transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;i
class=&quot;fas fa-envelope text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;span
id=&quot;messageCount&quot; class=&quot;absolute -top-1 -right-1 bg-red-500
text-white text-xs rounded-full w-5 h-5 flex items-center justify-center
hidden&quot;&gt;0&lt;/span&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
id=&quot;adminActions&quot; class=&quot;hidden items-center space-x-3&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;showAddNotebook()&quot; class=&quot;bg-green-500 hover:bg-green-600
text-white px-3 py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
&lt;i class=&quot;fas fa-plus mr-2&quot;&gt;&lt;/i&gt;เพิ่มสมุดโน้ต</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;showManageQuestions()&quot; class=&quot;bg-orange-500
hover:bg-orange-600 text-white px-3 py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
&lt;i class=&quot;fas fa-question-circle mr-2&quot;&gt;&lt;/i&gt;จัดการคำถาม</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;showAnnouncement()&quot; class=&quot;bg-blue-500
hover:bg-blue-600 text-white px-3 py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
&lt;i class=&quot;fas fa-bullhorn mr-2&quot;&gt;&lt;/i&gt;ประกาศระบบ</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;button
onclick=&quot;logout()&quot; class=&quot;bg-red-500 hover:bg-red-600 text-white
px-3 py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
&lt;i class=&quot;fas fa-sign-out-alt mr-2&quot;&gt;&lt;/i&gt;ออกจากระบบ</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;button
id=&quot;loginBtn&quot; onclick=&quot;showLogin()&quot;
class=&quot;bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg
transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-sign-in-alt mr-2&quot;&gt;&lt;/i&gt;เข้าสู่ระบบ</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>        </span></p>

<p class=MsoNormal><span lang=EN>        &lt;!-- Mobile Menu --&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div id=&quot;mobileMenu&quot;
class=&quot;hidden md:hidden bg-white border-t border-gray-200
shadow-lg&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;container
mx-auto px-4 py-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;nav
class=&quot;space-y-3&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;a href=&quot;#&quot;
onclick=&quot;showHome(); closeMobileMenu()&quot; class=&quot;flex items-center
text-gray-700 hover:text-purple-600 transition-colors py-2&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-home mr-3&quot;&gt;&lt;/i&gt;หน้าแรก</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/a&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;a href=&quot;#&quot;
onclick=&quot;showNotebooks(); closeMobileMenu()&quot; class=&quot;flex
items-center text-gray-700 hover:text-purple-600 transition-colors
py-2&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-book mr-3&quot;&gt;&lt;/i&gt;สมุดโน้ต</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/a&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;a href=&quot;#&quot;
onclick=&quot;showFeedback(); closeMobileMenu()&quot; class=&quot;flex
items-center text-gray-700 hover:text-purple-600 transition-colors
py-2&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-comment mr-3&quot;&gt;&lt;/i&gt;ส่งข้อเสนอแนะ</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/a&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/nav&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/header&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;!-- Main Content --&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;main class=&quot;container mx-auto
px-4 py-8&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;!-- Home Section --&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div id=&quot;homeSection&quot;
class=&quot;fade-in&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;!-- Hero Section --&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;section
class=&quot;hero-gradient text-white rounded-2xl p-12 mb-12
text-center&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
&lt;h1 class=&quot;text-5xl font-bold mb-6&quot;&gt;ยินดีต้อนรับสู่
NoTeBooK&lt;/h1&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                &lt;p
class=&quot;text-xl mb-8 opacity-90&quot;&gt;แพลตฟอร์มแชร์สมุดโน้ตและความรู้ที่ดีที่สุด&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;flex
justify-center space-x-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;button
onclick=&quot;showRegister()&quot; class=&quot;bg-white text-purple-600 px-8
py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-user-plus mr-2&quot;&gt;&lt;/i&gt;เริ่มต้นใช้งาน</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/section&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;!-- Dashboard Ranking Section
--&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;section
class=&quot;mb-12&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;h2 class=&quot;text-3xl
font-bold text-center mb-8 text-gray-800&quot;&gt;&#127942; Dashboard: สมุดโน้ตยอดนิยม
TOP 3&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div
id=&quot;topNotebooks&quot; class=&quot;grid md:grid-cols-3 gap-8&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;!-- Top notebooks will
be loaded here --&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/section&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;!-- Quiz Section --&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;section
class=&quot;mb-12&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;h2 class=&quot;text-3xl
font-bold text-center mb-8 text-gray-800&quot;&gt;&#129504; แบบทดสอบความรู้&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div
id=&quot;quizSection&quot; class=&quot;max-w-4xl mx-auto&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;!-- Quiz content will
be loaded here --&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/section&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;!-- Features Section --&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;section
class=&quot;mb-12&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
&lt;h2 class=&quot;text-3xl font-bold text-center mb-8 text-gray-800&quot;&gt;คุณสมบัติเด่น&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;grid
md:grid-cols-3 gap-8&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;bg-white p-6 rounded-xl shadow-lg card-hover&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;text-purple-600 text-4xl mb-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;i
class=&quot;fas fa-share-alt&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;h3 class=&quot;text-xl font-semibold mb-3&quot;&gt;แชร์ความรู้&lt;/h3&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;p class=&quot;text-gray-600&quot;&gt;แบ่งปันสมุดโน้ตและความรู้ของคุณให้กับชุมชน&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;bg-white p-6 rounded-xl shadow-lg card-hover&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;text-purple-600 text-4xl mb-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;i
class=&quot;fas fa-download&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;h3 class=&quot;text-xl font-semibold mb-3&quot;&gt;ดาวน์โหลดง่าย&lt;/h3&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>              
         &lt;p class=&quot;text-gray-600&quot;&gt;ดาวน์โหลดสมุดโน้ตที่ต้องการได้อย่างสะดวก&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;bg-white p-6 rounded-xl shadow-lg card-hover&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;text-purple-600 text-4xl mb-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;i
class=&quot;fas fa-users&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;h3 class=&quot;text-xl font-semibold mb-3&quot;&gt;ชุมชนการเรียนรู้&lt;/h3&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;p class=&quot;text-gray-600&quot;&gt;เข้าร่วมชุมชนผู้เรียนรู้และแลกเปลี่ยนประสบการณ์&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/section&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;!-- Notebooks Section --&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div
id=&quot;notebooksSection&quot; class=&quot;hidden&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;flex
justify-between items-center mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
&lt;h2 class=&quot;text-3xl font-bold text-gray-800&quot;&gt;สมุดโน้ตทั้งหมด&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;flex
items-center space-x-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;relative&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;input type=&quot;text&quot; id=&quot;searchInput&quot; placeholder=&quot;ค้นหาสมุดโน้ต...&quot;
</span></p>

<p class=MsoNormal><span lang=EN>                              
class=&quot;pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;i class=&quot;fas
fa-search absolute left-3 top-3 text-gray-400&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;button
onclick=&quot;searchNotebooks()&quot; class=&quot;bg-purple-600
hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-search mr-2&quot;&gt;&lt;/i&gt;ค้นหา</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div id=&quot;notebooksList&quot;
class=&quot;grid md:grid-cols-2 lg:grid-cols-3 gap-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;!-- Notebooks will be
loaded here --&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;!-- Feedback Section --&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div id=&quot;feedbackSection&quot;
class=&quot;hidden&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;max-w-2xl
mx-auto bg-white rounded-xl shadow-lg p-8&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
&lt;h2 class=&quot;text-3xl font-bold text-center mb-6 text-gray-800&quot;&gt;ส่งข้อเสนอแนะ&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;form id=&quot;feedbackForm&quot;
class=&quot;space-y-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;หัวข้อ&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;input
type=&quot;text&quot; id=&quot;feedbackSubject&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                               class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;ข้อเสนอแนะ&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;textarea
id=&quot;feedbackMessage&quot; rows=&quot;6&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                                 
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;&lt;/textarea&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;button
type=&quot;submit&quot; class=&quot;w-full bg-purple-600 hover:bg-purple-700
text-white py-3 rounded-lg font-semibold transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-paper-plane mr-2&quot;&gt;&lt;/i&gt;ส่งข้อเสนอแนะ</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/form&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/main&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;!-- Login Modal --&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;div id=&quot;loginModal&quot;
class=&quot;fixed inset-0 bg-black bg-opacity-50 hidden items-center
justify-center z-50&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div class=&quot;bg-white
rounded-xl p-8 max-w-md w-full mx-4 slide-up&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;flex
justify-between items-center mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                &lt;h2
class=&quot;text-2xl font-bold text-gray-800&quot;&gt;เข้าสู่ระบบ&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
onclick=&quot;closeModal('loginModal')&quot; class=&quot;text-gray-500
hover:text-gray-700&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;i class=&quot;fas
fa-times text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;form id=&quot;loginForm&quot;
class=&quot;space-y-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;ชื่อผู้ใช้&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;input
type=&quot;text&quot; id=&quot;loginUsername&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                           class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;รหัสผ่าน&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;input type=&quot;password&quot;
id=&quot;loginPassword&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                           class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;flex
space-x-3&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;button
type=&quot;button&quot; onclick=&quot;closeModal('loginModal')&quot; </span></p>

<p class=MsoNormal><span lang=EN>                            class=&quot;flex-1
bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 rounded-lg
transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
ยกเลิก</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;button
type=&quot;submit&quot; class=&quot;flex-1 bg-purple-600 hover:bg-purple-700
text-white py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
ตกลง</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/form&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;mt-4
text-center&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
onclick=&quot;showRegister()&quot; class=&quot;text-purple-600
hover:text-purple-700 font-medium&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
ลงทะเบียน</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;!-- Register Modal --&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;div id=&quot;registerModal&quot;
class=&quot;fixed inset-0 bg-black bg-opacity-50 hidden items-center
justify-center z-50&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div class=&quot;bg-white
rounded-xl p-8 max-w-md w-full mx-4 slide-up&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;flex justify-between
items-center mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
&lt;h2 class=&quot;text-2xl font-bold text-gray-800&quot;&gt;ลงทะเบียน&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
onclick=&quot;closeModal('registerModal')&quot; class=&quot;text-gray-500
hover:text-gray-700&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;i class=&quot;fas
fa-times text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;form
id=&quot;registerForm&quot; class=&quot;space-y-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;ชื่อที่แสดง&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;input
type=&quot;text&quot; id=&quot;registerDisplayName&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                           class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;ชื่อผู้ใช้&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;input
type=&quot;text&quot; id=&quot;registerUsername&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                           class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;อีเมล&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;input
type=&quot;email&quot; id=&quot;registerEmail&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                           class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;รหัสผ่าน&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;input
type=&quot;password&quot; id=&quot;registerPassword&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                           class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;ยืนยันรหัสผ่าน&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;input
type=&quot;password&quot; id=&quot;registerConfirmPassword&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                           class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
type=&quot;submit&quot; class=&quot;w-full bg-purple-600 hover:bg-purple-700
text-white py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>            
       ลงทะเบียน</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/form&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;!-- Add Notebook Modal --&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;div id=&quot;addNotebookModal&quot;
class=&quot;fixed inset-0 bg-black bg-opacity-50 hidden items-center
justify-center z-50&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div class=&quot;bg-white
rounded-xl p-8 max-w-2xl w-full mx-4 slide-up max-h-[90vh]
overflow-y-auto&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;flex
justify-between items-center mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
&lt;h2 class=&quot;text-2xl font-bold text-gray-800&quot;&gt;เพิ่มสมุดโน้ต&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
onclick=&quot;closeModal('addNotebookModal')&quot; class=&quot;text-gray-500
hover:text-gray-700&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;i class=&quot;fas
fa-times text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;form
id=&quot;addNotebookForm&quot; class=&quot;space-y-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;หัวข้อสมุดโน้ต&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;input
type=&quot;text&quot; id=&quot;notebookTitle&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                           class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;รายละเอียด&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;textarea
id=&quot;notebookDescription&quot; rows=&quot;4&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                             
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;&lt;/textarea&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;รูปตัวอย่าง
(ลิงค์)&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;input
type=&quot;url&quot; id=&quot;notebookImage&quot;
placeholder=&quot;https://example.com/image.jpg&quot;</span></p>

<p class=MsoNormal><span lang=EN>                           class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;ไฟล์สมุดโน้ต&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;input
type=&quot;file&quot; id=&quot;notebookFile&quot;
accept=&quot;.pdf,.doc,.docx,.txt&quot; </span></p>

<p class=MsoNormal><span lang=EN>                           class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
type=&quot;submit&quot; class=&quot;w-full bg-green-500 hover:bg-green-600
text-white py-3 rounded-lg font-semibold transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;i class=&quot;fas fa-plus mr-2&quot;&gt;&lt;/i&gt;เพิ่มสมุดโน้ต</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/form&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;!-- Messages Modal --&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;div id=&quot;messagesModal&quot;
class=&quot;fixed inset-0 bg-black bg-opacity-50 hidden items-center
justify-center z-50&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div class=&quot;bg-white
rounded-xl p-8 max-w-4xl w-full mx-4 slide-up max-h-[90vh]
overflow-y-auto&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;flex
justify-between items-center mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
&lt;h2 class=&quot;text-2xl font-bold text-gray-800&quot;&gt;ข้อความ&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
onclick=&quot;closeModal('messagesModal')&quot; class=&quot;text-gray-500
hover:text-gray-700&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;i class=&quot;fas
fa-times text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div
id=&quot;messagesList&quot; class=&quot;space-y-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;!-- Messages will be
loaded here --&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;!-- Announcement Modal --&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;div id=&quot;announcementModal&quot;
class=&quot;fixed inset-0 bg-black bg-opacity-50 hidden items-center
justify-center z-50&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div class=&quot;bg-white
rounded-xl p-8 max-w-md w-full mx-4 slide-up&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;flex
justify-between items-center mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
&lt;h2 class=&quot;text-2xl font-bold text-gray-800&quot;&gt;ประกาศระบบ&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
onclick=&quot;closeModal('announcementModal')&quot; class=&quot;text-gray-500
hover:text-gray-700&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;i class=&quot;fas
fa-times text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;form
id=&quot;announcementForm&quot; class=&quot;space-y-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;หัวข้อประกาศ&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;input
type=&quot;text&quot; id=&quot;announcementTitle&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                           class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;เนื้อหาประกาศ&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;textarea
id=&quot;announcementContent&quot; rows=&quot;6&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                             
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;&lt;/textarea&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
type=&quot;submit&quot; class=&quot;w-full bg-blue-500 hover:bg-blue-600
text-white py-3 rounded-lg font-semibold transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;i class=&quot;fas fa-bullhorn mr-2&quot;&gt;&lt;/i&gt;ส่งประกาศ</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/form&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;!-- Manage Questions Modal --&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;div id=&quot;manageQuestionsModal&quot;
class=&quot;fixed inset-0 bg-black bg-opacity-50 hidden items-center
justify-center z-50&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div class=&quot;bg-white
rounded-xl p-8 max-w-6xl w-full mx-4 slide-up max-h-[90vh]
overflow-y-auto&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;flex
justify-between items-center mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
&lt;h2 class=&quot;text-2xl font-bold text-gray-800&quot;&gt;จัดการคำถาม&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
onclick=&quot;closeModal('manageQuestionsModal')&quot;
class=&quot;text-gray-500 hover:text-gray-700&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;i class=&quot;fas
fa-times text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
onclick=&quot;showAddQuestion()&quot; class=&quot;bg-green-500
hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                    &lt;i
class=&quot;fas fa-plus mr-2&quot;&gt;&lt;/i&gt;เพิ่มคำถามใหม่</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            &lt;div
id=&quot;questionsList&quot; class=&quot;space-y-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;!-- Questions will be
loaded here --&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;!-- Add/Edit Question Modal --&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;div id=&quot;addQuestionModal&quot;
class=&quot;fixed inset-0 bg-black bg-opacity-50 hidden items-center
justify-center z-50&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div class=&quot;bg-white
rounded-xl p-8 max-w-2xl w-full mx-4 slide-up max-h-[90vh]
overflow-y-auto&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;div class=&quot;flex justify-between
items-center mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
&lt;h2 id=&quot;questionModalTitle&quot; class=&quot;text-2xl font-bold
text-gray-800&quot;&gt;เพิ่มคำถามใหม่&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;button
onclick=&quot;closeModal('addQuestionModal')&quot; class=&quot;text-gray-500
hover:text-gray-700&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;i class=&quot;fas
fa-times text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;form
id=&quot;questionForm&quot; class=&quot;space-y-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;คำถาม&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;textarea
id=&quot;questionText&quot; rows=&quot;3&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                             
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;&lt;/textarea&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;grid
grid-cols-1 md:grid-cols-2 gap-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;ตัวเลือก
A&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;input
type=&quot;text&quot; id=&quot;optionA&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                              
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;ตัวเลือก
B&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;input
type=&quot;text&quot; id=&quot;optionB&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                              
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;ตัวเลือก
C&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;input
type=&quot;text&quot; id=&quot;optionC&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                              
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;ตัวเลือก
D&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;input type=&quot;text&quot;
id=&quot;optionD&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                              
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                    &lt;label
class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;คำตอบที่ถูกต้อง&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;select
id=&quot;correctAnswer&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                            class=&quot;w-full
px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500
focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;option value=&quot;&quot;&gt;เลือกคำตอบที่ถูกต้อง&lt;/option&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;option
value=&quot;A&quot;&gt;A&lt;/option&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;option
value=&quot;B&quot;&gt;B&lt;/option&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;option
value=&quot;C&quot;&gt;C&lt;/option&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;option
value=&quot;D&quot;&gt;D&lt;/option&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/select&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;คำอธิบาย
(ไม่บังคับ)&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;textarea
id=&quot;explanation&quot; rows=&quot;3&quot; </span></p>

<p class=MsoNormal><span lang=EN>                             
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;&lt;/textarea&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;flex
space-x-3&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;button
type=&quot;button&quot; onclick=&quot;closeModal('addQuestionModal')&quot; </span></p>

<p class=MsoNormal><span lang=EN>                            class=&quot;flex-1
bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 rounded-lg
transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
ยกเลิก</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;button
type=&quot;submit&quot; class=&quot;flex-1 bg-green-500 hover:bg-green-600
text-white py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-save mr-2&quot;&gt;&lt;/i&gt;บันทึก</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;/form&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;!-- Notification --&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;div id=&quot;notification&quot;
class=&quot;notification hidden&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;div class=&quot;bg-green-500
text-white px-6 py-3 rounded-lg shadow-lg&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>            &lt;span
id=&quot;notificationText&quot;&gt;&lt;/span&gt;</span></p>

<p class=MsoNormal><span lang=EN>        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>    &lt;script&gt;</span></p>

<p class=MsoNormal><span lang=EN>        // Global variables</span></p>

<p class=MsoNormal><span lang=EN>        let currentUser = null;</span></p>

<p class=MsoNormal><span lang=EN>        let notebooks = [];</span></p>

<p class=MsoNormal><span lang=EN>        let users = [];</span></p>

<p class=MsoNormal><span lang=EN>        let messages = [];</span></p>

<p class=MsoNormal><span lang=EN>        let questions = [];</span></p>

<p class=MsoNormal><span lang=EN>        let isAdmin = false;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Initialize data from localStorage</span></p>

<p class=MsoNormal><span lang=EN>        function initializeData() {</span></p>

<p class=MsoNormal><span lang=EN>            const savedNotebooks =
localStorage.getItem('notebooks');</span></p>

<p class=MsoNormal><span lang=EN>            const savedUsers =
localStorage.getItem('users');</span></p>

<p class=MsoNormal><span lang=EN>            const savedMessages =
localStorage.getItem('messages');</span></p>

<p class=MsoNormal><span lang=EN>            const savedQuestions =
localStorage.getItem('questions');</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (savedNotebooks) {</span></p>

<p class=MsoNormal><span lang=EN>                notebooks =
JSON.parse(savedNotebooks);</span></p>

<p class=MsoNormal><span lang=EN>            } else {</span></p>

<p class=MsoNormal><span lang=EN>                notebooks = [];</span></p>

<p class=MsoNormal><span lang=EN>                saveData();</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (savedUsers) {</span></p>

<p class=MsoNormal><span lang=EN>                users =
JSON.parse(savedUsers);</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (savedMessages) {</span></p>

<p class=MsoNormal><span lang=EN>                messages =
JSON.parse(savedMessages);</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (savedQuestions) {</span></p>

<p class=MsoNormal><span lang=EN>                questions =
JSON.parse(savedQuestions);</span></p>

<p class=MsoNormal><span lang=EN>            } else {</span></p>

<p class=MsoNormal><span lang=EN>                questions = [];</span></p>

<p class=MsoNormal><span lang=EN>                saveData();</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Save data to localStorage and sync
across devices</span></p>

<p class=MsoNormal><span lang=EN>        function saveData() {</span></p>

<p class=MsoNormal><span lang=EN>            const data = {</span></p>

<p class=MsoNormal><span lang=EN>                notebooks: notebooks,</span></p>

<p class=MsoNormal><span lang=EN>                users: users,</span></p>

<p class=MsoNormal><span lang=EN>                messages: messages,</span></p>

<p class=MsoNormal><span lang=EN>                questions: questions,</span></p>

<p class=MsoNormal><span lang=EN>                lastSync: new
Date().toISOString()</span></p>

<p class=MsoNormal><span lang=EN>            };</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            localStorage.setItem('notebooks',
JSON.stringify(notebooks));</span></p>

<p class=MsoNormal><span lang=EN>            localStorage.setItem('users',
JSON.stringify(users));</span></p>

<p class=MsoNormal><span lang=EN>            localStorage.setItem('messages',
JSON.stringify(messages));</span></p>

<p class=MsoNormal><span lang=EN>            localStorage.setItem('questions',
JSON.stringify(questions));</span></p>

<p class=MsoNormal><span lang=EN>            localStorage.setItem('lastSync',
data.lastSync);</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Simulate cloud sync (in real
app, this would sync to a server)</span></p>

<p class=MsoNormal><span lang=EN>            localStorage.setItem('cloudData',
JSON.stringify(data));</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Trigger sync event for other
tabs/windows</span></p>

<p class=MsoNormal><span lang=EN>            window.dispatchEvent(new StorageEvent('storage',
{</span></p>

<p class=MsoNormal><span lang=EN>                key: 'cloudData',</span></p>

<p class=MsoNormal><span lang=EN>                newValue: JSON.stringify(data)</span></p>

<p class=MsoNormal><span lang=EN>            }));</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Sync data from cloud/other devices</span></p>

<p class=MsoNormal><span lang=EN>        function syncData() {</span></p>

<p class=MsoNormal><span lang=EN>            const cloudData = localStorage.getItem('cloudData');</span></p>

<p class=MsoNormal><span lang=EN>            if (cloudData) {</span></p>

<p class=MsoNormal><span lang=EN>                const data =
JSON.parse(cloudData);</span></p>

<p class=MsoNormal><span lang=EN>                const localLastSync =
localStorage.getItem('lastSync');</span></p>

<p class=MsoNormal><span lang=EN>                </span></p>

<p class=MsoNormal><span lang=EN>                // If cloud data is newer,
update local data</span></p>

<p class=MsoNormal><span lang=EN>                if (!localLastSync || new
Date(data.lastSync) &gt; new Date(localLastSync)) {</span></p>

<p class=MsoNormal><span lang=EN>                    notebooks = data.notebooks
|| [];</span></p>

<p class=MsoNormal><span lang=EN>                    users = data.users || [];</span></p>

<p class=MsoNormal><span lang=EN>                    messages = data.messages
|| [];</span></p>

<p class=MsoNormal><span lang=EN>                    questions = data.questions
|| [];</span></p>

<p class=MsoNormal><span lang=EN>                    </span></p>

<p class=MsoNormal><span lang=EN>                   
localStorage.setItem('notebooks', JSON.stringify(notebooks));</span></p>

<p class=MsoNormal><span lang=EN>                   
localStorage.setItem('users', JSON.stringify(users));</span></p>

<p class=MsoNormal><span lang=EN>                   
localStorage.setItem('messages', JSON.stringify(messages));</span></p>

<p class=MsoNormal><span lang=EN>                   
localStorage.setItem('questions', JSON.stringify(questions));</span></p>

<p class=MsoNormal><span lang=EN>                   
localStorage.setItem('lastSync', data.lastSync);</span></p>

<p class=MsoNormal><span lang=EN>                    </span></p>

<p class=MsoNormal><span lang=EN>                    // Refresh UI if user is
logged in</span></p>

<p class=MsoNormal><span lang=EN>                    if (currentUser) {</span></p>

<p class=MsoNormal><span lang=EN>                        loadNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>                        loadTopNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>                        updateMessageCount();</span></p>

<p class=MsoNormal><span lang=EN>                        loadQuestions();</span></p>

<p class=MsoNormal><span lang=EN>                    }</span></p>

<p class=MsoNormal><span lang=EN>                }</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Mobile menu functions</span></p>

<p class=MsoNormal><span lang=EN>        function toggleMobileMenu() {</span></p>

<p class=MsoNormal><span lang=EN>            const mobileMenu = document.getElementById('mobileMenu');</span></p>

<p class=MsoNormal><span lang=EN>           
mobileMenu.classList.toggle('hidden');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function closeMobileMenu() {</span></p>

<p class=MsoNormal><span lang=EN>            const mobileMenu =
document.getElementById('mobileMenu');</span></p>

<p class=MsoNormal><span lang=EN>           
mobileMenu.classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Show notification</span></p>

<p class=MsoNormal><span lang=EN>        function showNotification(message,
type = 'success') {</span></p>

<p class=MsoNormal><span lang=EN>            const notification = document.getElementById('notification');</span></p>

<p class=MsoNormal><span lang=EN>            const notificationText =
document.getElementById('notificationText');</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            notificationText.textContent =
message;</span></p>

<p class=MsoNormal><span lang=EN>            notification.className =
`notification ${type === 'success' ? 'bg-green-500' : 'bg-red-500'} text-white
px-6 py-3 rounded-lg shadow-lg`;</span></p>

<p class=MsoNormal><span lang=EN>           
notification.classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            setTimeout(() =&gt; {</span></p>

<p class=MsoNormal><span lang=EN>               
notification.classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            }, 3000);</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Navigation functions</span></p>

<p class=MsoNormal><span lang=EN>        function showHome() {</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('homeSection').classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('notebooksSection').classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            document.getElementById('feedbackSection').classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            loadTopNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>            loadQuestions();</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function showNotebooks() {</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('homeSection').classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('notebooksSection').classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('feedbackSection').classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            loadNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function showFeedback() {</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('homeSection').classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('notebooksSection').classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            document.getElementById('feedbackSection').classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Modal functions</span></p>

<p class=MsoNormal><span lang=EN>        function showLogin() {</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('loginModal').classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('loginModal').classList.add('flex');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function showRegister() {</span></p>

<p class=MsoNormal><span lang=EN>            closeModal('loginModal');</span></p>

<p class=MsoNormal><span lang=EN>            document.getElementById('registerModal').classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('registerModal').classList.add('flex');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function showAddNotebook() {</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('addNotebookModal').classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('addNotebookModal').classList.add('flex');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function showMessages() {</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('messagesModal').classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('messagesModal').classList.add('flex');</span></p>

<p class=MsoNormal><span lang=EN>            loadMessages();</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function showManageQuestions() {</span></p>

<p class=MsoNormal><span lang=EN>            document.getElementById('manageQuestionsModal').classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('manageQuestionsModal').classList.add('flex');</span></p>

<p class=MsoNormal><span lang=EN>            loadQuestionsForManagement();</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function showAddQuestion() {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
document.getElementById('questionModalTitle').textContent = 'เพิ่มคำถามใหม่';</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('questionForm').reset();</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('questionForm').dataset.editId = '';</span></p>

<p class=MsoNormal><span lang=EN>            document.getElementById('addQuestionModal').classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('addQuestionModal').classList.add('flex');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function showAnnouncement() {</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('announcementModal').classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            document.getElementById('announcementModal').classList.add('flex');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function closeModal(modalId) {</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById(modalId).classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById(modalId).classList.remove('flex');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Authentication functions</span></p>

<p class=MsoNormal><span lang=EN>        function login(username, password) {</span></p>

<p class=MsoNormal><span lang=EN>            // Check admin credentials</span></p>

<p class=MsoNormal><span lang=EN>            if (username === 'mgmkaroi'
&amp;&amp; password === 'mkmkMk21') {</span></p>

<p class=MsoNormal><span lang=EN>                currentUser = { username:
'mgmkaroi', displayName: 'Admin', email: 'mongkhonchatchawan.n@gmail.com',
isAdmin: true };</span></p>

<p class=MsoNormal><span lang=EN>                isAdmin = true;</span></p>

<p class=MsoNormal><span lang=EN>                updateUI();</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('เข้าสู่ระบบสำเร็จ!');</span></p>

<p class=MsoNormal><span lang=EN>                closeModal('loginModal');</span></p>

<p class=MsoNormal><span lang=EN>                return true;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Check regular users</span></p>

<p class=MsoNormal><span lang=EN>            const user = users.find(u =&gt;
u.username === username &amp;&amp; u.password === password);</span></p>

<p class=MsoNormal><span lang=EN>            if (user) {</span></p>

<p class=MsoNormal><span lang=EN>                currentUser = user;</span></p>

<p class=MsoNormal><span lang=EN>                isAdmin = false;</span></p>

<p class=MsoNormal><span lang=EN>                updateUI();</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('เข้าสู่ระบบสำเร็จ!');</span></p>

<p class=MsoNormal><span lang=EN>                closeModal('loginModal');</span></p>

<p class=MsoNormal><span lang=EN>                return true;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification('ชื่อผู้ใช้หรือรหัสผ่านไม่ถูกต้อง หรือยังไม่ได้ลงทะเบียน?',
'error');</span></p>

<p class=MsoNormal><span lang=EN>            return false;</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function register(displayName,
username, email, password, confirmPassword) {</span></p>

<p class=MsoNormal><span lang=EN>            if (password !== confirmPassword)
{</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('รหัสผ่านไม่ตรงกัน', 'error');</span></p>

<p class=MsoNormal><span lang=EN>                return false;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (users.find(u =&gt; u.username
=== username)) {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('ชื่อผู้ใช้นี้มีอยู่แล้ว', 'error');</span></p>

<p class=MsoNormal><span lang=EN>                return false;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const newUser = {</span></p>

<p class=MsoNormal><span lang=EN>                id: Date.now(),</span></p>

<p class=MsoNormal><span lang=EN>                displayName,</span></p>

<p class=MsoNormal><span lang=EN>                username,</span></p>

<p class=MsoNormal><span lang=EN>                email,</span></p>

<p class=MsoNormal><span lang=EN>                password,</span></p>

<p class=MsoNormal><span lang=EN>                isAdmin: false,</span></p>

<p class=MsoNormal><span lang=EN>                joinDate: new
Date().toISOString()</span></p>

<p class=MsoNormal><span lang=EN>            };</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            users.push(newUser);</span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification('ลงทะเบียนสำเร็จ!');</span></p>

<p class=MsoNormal><span lang=EN>            closeModal('registerModal');</span></p>

<p class=MsoNormal><span lang=EN>            return true;</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function logout() {</span></p>

<p class=MsoNormal><span lang=EN>            currentUser = null;</span></p>

<p class=MsoNormal><span lang=EN>            isAdmin = false;</span></p>

<p class=MsoNormal><span lang=EN>            updateUI();</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification('ออกจากระบบแล้ว');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function updateUI() {</span></p>

<p class=MsoNormal><span lang=EN>            const loginBtn =
document.getElementById('loginBtn');</span></p>

<p class=MsoNormal><span lang=EN>            const userActions =
document.getElementById('userActions');</span></p>

<p class=MsoNormal><span lang=EN>            const adminActions =
document.getElementById('adminActions');</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (currentUser) {</span></p>

<p class=MsoNormal><span lang=EN>               
loginBtn.classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>               
userActions.classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>                userActions.classList.add('flex');</span></p>

<p class=MsoNormal><span lang=EN>                </span></p>

<p class=MsoNormal><span lang=EN>                if (isAdmin) {</span></p>

<p class=MsoNormal><span lang=EN>                   
adminActions.classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>                   
adminActions.classList.add('flex');</span></p>

<p class=MsoNormal><span lang=EN>                } else {</span></p>

<p class=MsoNormal><span lang=EN>                   
adminActions.classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>                   
adminActions.classList.remove('flex');</span></p>

<p class=MsoNormal><span lang=EN>                }</span></p>

<p class=MsoNormal><span lang=EN>            } else {</span></p>

<p class=MsoNormal><span lang=EN>               
loginBtn.classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>               
userActions.classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>                userActions.classList.remove('flex');</span></p>

<p class=MsoNormal><span lang=EN>               
adminActions.classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>               
adminActions.classList.remove('flex');</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            loadNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>            updateMessageCount();</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Image type toggle functions</span></p>

<p class=MsoNormal><span lang=EN>        function toggleImageInput() {</span></p>

<p class=MsoNormal><span lang=EN>            const imageType =
document.querySelector('input[name=&quot;imageType&quot;]:checked').value;</span></p>

<p class=MsoNormal><span lang=EN>            const urlInput =
document.getElementById('imageUrlInput');</span></p>

<p class=MsoNormal><span lang=EN>            const fileInput =
document.getElementById('imageFileInput');</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (imageType === 'url') {</span></p>

<p class=MsoNormal><span lang=EN>               
urlInput.classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>               
fileInput.classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            } else {</span></p>

<p class=MsoNormal><span lang=EN>                urlInput.classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>               
fileInput.classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function toggleEditImageInput() {</span></p>

<p class=MsoNormal><span lang=EN>            const imageType =
document.querySelector('input[name=&quot;editImageType&quot;]:checked').value;</span></p>

<p class=MsoNormal><span lang=EN>            const urlInput =
document.getElementById('editImageUrlInput');</span></p>

<p class=MsoNormal><span lang=EN>            const fileInput =
document.getElementById('editImageFileInput');</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (imageType === 'url') {</span></p>

<p class=MsoNormal><span lang=EN>               
urlInput.classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>               
fileInput.classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            } else {</span></p>

<p class=MsoNormal><span lang=EN>               
urlInput.classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>               
fileInput.classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Top Notebooks functions</span></p>

<p class=MsoNormal><span lang=EN>        function loadTopNotebooks() {</span></p>

<p class=MsoNormal><span lang=EN>            const topNotebooksContainer =
document.getElementById('topNotebooks');</span></p>

<p class=MsoNormal><span lang=EN>            topNotebooksContainer.innerHTML =
'';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Sort notebooks by likes
(descending) and get top 3</span></p>

<p class=MsoNormal><span lang=EN>            const topNotebooks =
[...notebooks]</span></p>

<p class=MsoNormal><span lang=EN>                .sort((a, b) =&gt; b.likes -
a.likes)</span></p>

<p class=MsoNormal><span lang=EN>                .slice(0, 3);</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (topNotebooks.length === 0) {</span></p>

<p class=MsoNormal><span lang=EN>               
topNotebooksContainer.innerHTML = `</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;col-span-3 text-center py-12&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;text-gray-400 text-6xl mb-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;i
class=&quot;fas fa-book-open&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;p class=&quot;text-gray-600 text-lg&quot;&gt;ยังไม่มีสมุดโน้ตในระบบ&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;p class=&quot;text-gray-500&quot;&gt;รอสักครู่เพื่อดูสมุดโน้ตยอดนิยม&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                `;</span></p>

<p class=MsoNormal><span lang=EN>                return;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            topNotebooks.forEach((notebook,
index) =&gt; {</span></p>

<p class=MsoNormal><span lang=EN>                const rankCard =
createTopNotebookCard(notebook, index + 1);</span></p>

<p class=MsoNormal><span lang=EN>               
topNotebooksContainer.appendChild(rankCard);</span></p>

<p class=MsoNormal><span lang=EN>            });</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function
createTopNotebookCard(notebook, rank) {</span></p>

<p class=MsoNormal><span lang=EN>            const card = document.createElement('div');</span></p>

<p class=MsoNormal><span lang=EN>            card.className = 'bg-white
rounded-xl shadow-lg overflow-hidden card-hover relative';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Rank colors and icons</span></p>

<p class=MsoNormal><span lang=EN>            const rankStyles = {</span></p>

<p class=MsoNormal><span lang=EN>                1: { bg: 'bg-gradient-to-br
from-yellow-400 to-yellow-600', icon: '&#128081;', text: 'text-yellow-800' },</span></p>

<p class=MsoNormal><span lang=EN>                2: { bg: 'bg-gradient-to-br
from-gray-300 to-gray-500', icon: '&#129352;', text: 'text-gray-800' },</span></p>

<p class=MsoNormal><span lang=EN>                3: { bg: 'bg-gradient-to-br
from-orange-400 to-orange-600', icon: '&#129353;', text: 'text-orange-800' }</span></p>

<p class=MsoNormal><span lang=EN>            };</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const style = rankStyles[rank] ||
rankStyles[3];</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            card.innerHTML = `</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div
class=&quot;relative&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;!-- Rank Badge --&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;absolute top-3 left-3 ${style.bg} text-white px-3 py-2 rounded-full
font-bold text-sm z-10 shadow-lg&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;span
class=&quot;mr-1&quot;&gt;${style.icon}&lt;/span&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        #${rank}</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    </span></p>

<p class=MsoNormal><span lang=EN>                    &lt;img
src=&quot;${notebook.image ||
'https://via.placeholder.com/300x200?text=Notebook'}&quot; </span></p>

<p class=MsoNormal><span lang=EN>                        
alt=&quot;${notebook.title}&quot; class=&quot;w-full h-48
object-cover&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    </span></p>

<p class=MsoNormal><span lang=EN>                    &lt;!-- Likes Badge --&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;absolute top-3 right-3 bg-red-500 text-white px-3 py-2 rounded-full
font-bold text-sm shadow-lg&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;i class=&quot;fas
fa-heart mr-1&quot;&gt;&lt;/i&gt;${notebook.likes}</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                </span></p>

<p class=MsoNormal><span lang=EN>                &lt;div
class=&quot;p-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;flex
items-center mb-3&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;text-2xl mr-2&quot;&gt;${style.icon}&lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;h3 class=&quot;text-xl font-bold ${style.text}&quot;&gt;อันดับ ${rank}&lt;/h3&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    </span></p>

<p class=MsoNormal><span lang=EN>                    &lt;h4 class=&quot;text-lg
font-semibold mb-2 text-gray-800
line-clamp-2&quot;&gt;${notebook.title}&lt;/h4&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;p
class=&quot;text-gray-600 mb-4 text-sm
line-clamp-3&quot;&gt;${notebook.description}&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    </span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;flex
justify-between items-center text-sm text-gray-500 mb-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;span&gt;&lt;i
class=&quot;fas fa-calendar mr-1&quot;&gt;&lt;/i&gt;${new
Date(notebook.uploadDate).toLocaleDateString('th-TH')}&lt;/span&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;span&gt;&lt;i
class=&quot;fas fa-comment
mr-1&quot;&gt;&lt;/i&gt;${notebook.comments.length}&lt;/span&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    </span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;flex
items-center justify-between&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;flex items-center space-x-2&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;div
class=&quot;flex items-center text-red-500 font-semibold&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                &lt;i
class=&quot;fas fa-heart mr-1&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
&lt;span&gt;${notebook.likes} ใจ&lt;/span&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        </span></p>

<p class=MsoNormal><span lang=EN>                        ${currentUser ? `</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;viewNotebookDetails(${notebook.id})&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                   
class=&quot;bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg
text-sm transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
&lt;i class=&quot;fas fa-eye mr-1&quot;&gt;&lt;/i&gt;ดูรายละเอียด</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        ` : `</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;showLogin()&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                   
class=&quot;bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg
text-sm transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
&lt;i class=&quot;fas fa-lock mr-1&quot;&gt;&lt;/i&gt;เข้าสู่ระบบ</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        `}</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            `;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            return card;</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function viewNotebookDetails(id) {</span></p>

<p class=MsoNormal><span lang=EN>            const notebook = notebooks.find(n
=&gt; n.id === id);</span></p>

<p class=MsoNormal><span lang=EN>            if (!notebook) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Switch to notebooks section and
highlight the specific notebook</span></p>

<p class=MsoNormal><span lang=EN>            showNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Scroll to the notebook after a
short delay to ensure the section is loaded</span></p>

<p class=MsoNormal><span lang=EN>            setTimeout(() =&gt; {</span></p>

<p class=MsoNormal><span lang=EN>                const notebookCards =
document.querySelectorAll('#notebooksList &gt; div');</span></p>

<p class=MsoNormal><span lang=EN>                notebookCards.forEach(card
=&gt; {</span></p>

<p class=MsoNormal><span lang=EN>                    const cardTitle =
card.querySelector('h3');</span></p>

<p class=MsoNormal><span lang=EN>                    if (cardTitle &amp;&amp;
cardTitle.textContent === notebook.title) {</span></p>

<p class=MsoNormal><span lang=EN>                        card.scrollIntoView({
behavior: 'smooth', block: 'center' });</span></p>

<p class=MsoNormal><span lang=EN>                        card.style.border =
'3px solid #7c3aed';</span></p>

<p class=MsoNormal><span lang=EN>                        card.style.boxShadow =
'0 0 20px rgba(124, 58, 237, 0.3)';</span></p>

<p class=MsoNormal><span lang=EN>                        </span></p>

<p class=MsoNormal><span lang=EN>                        // Remove highlight
after 3 seconds</span></p>

<p class=MsoNormal><span lang=EN>                        setTimeout(() =&gt; {</span></p>

<p class=MsoNormal><span lang=EN>                            card.style.border
= '';</span></p>

<p class=MsoNormal><span lang=EN>                           
card.style.boxShadow = '';</span></p>

<p class=MsoNormal><span lang=EN>                        }, 3000);</span></p>

<p class=MsoNormal><span lang=EN>                    }</span></p>

<p class=MsoNormal><span lang=EN>                });</span></p>

<p class=MsoNormal><span lang=EN>            }, 100);</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Notebook functions</span></p>

<p class=MsoNormal><span lang=EN>        function loadNotebooks() {</span></p>

<p class=MsoNormal><span lang=EN>            const notebooksList =
document.getElementById('notebooksList');</span></p>

<p class=MsoNormal><span lang=EN>            notebooksList.innerHTML = '';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            notebooks.forEach(notebook =&gt; {</span></p>

<p class=MsoNormal><span lang=EN>                const notebookCard =
createNotebookCard(notebook);</span></p>

<p class=MsoNormal><span lang=EN>               
notebooksList.appendChild(notebookCard);</span></p>

<p class=MsoNormal><span lang=EN>            });</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function createNotebookCard(notebook)
{</span></p>

<p class=MsoNormal><span lang=EN>            const card =
document.createElement('div');</span></p>

<p class=MsoNormal><span lang=EN>            card.className = 'bg-white
rounded-xl shadow-lg overflow-hidden card-hover';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const isLiked = currentUser
&amp;&amp; notebook.likedBy.includes(currentUser.username);</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            card.innerHTML = `</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div
class=&quot;relative&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;img
src=&quot;${notebook.image ||
'https://via.placeholder.com/300x200?text=Notebook'}&quot; </span></p>

<p class=MsoNormal><span lang=EN>                         alt=&quot;${notebook.title}&quot;
class=&quot;w-full h-48 object-cover&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    ${isAdmin ? `</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;absolute top-2 right-2 flex space-x-2&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;editNotebook(${notebook.id})&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                    class=&quot;bg-blue-500
hover:bg-blue-600 text-white p-2 rounded-full&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                &lt;i
class=&quot;fas fa-edit&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;deleteNotebook(${notebook.id})&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                   
class=&quot;bg-red-500 hover:bg-red-600 text-white p-2 rounded-full&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                &lt;i
class=&quot;fas fa-trash&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    ` : ''}</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div
class=&quot;p-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;h3 class=&quot;text-xl
font-semibold mb-2 text-gray-800&quot;&gt;${notebook.title}&lt;/h3&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;p
class=&quot;text-gray-600 mb-4&quot;&gt;${notebook.description}&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;flex
justify-between items-center text-sm text-gray-500 mb-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;span&gt;&lt;i
class=&quot;fas fa-calendar mr-1&quot;&gt;&lt;/i&gt;${new
Date(notebook.uploadDate).toLocaleDateString('th-TH')}&lt;/span&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;span&gt;&lt;i
class=&quot;fas fa-heart mr-1&quot;&gt;&lt;/i&gt;${notebook.likes}&lt;/span&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    ${currentUser ? `</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;flex space-x-2&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;downloadNotebook(${notebook.id})&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                   
class=&quot;flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 px-4
rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
&lt;i class=&quot;fas fa-download mr-2&quot;&gt;&lt;/i&gt;ดาวน์โหลด</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;toggleLike(${notebook.id})&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                   
class=&quot;bg-${isLiked ? 'red' : 'gray'}-500 hover:bg-${isLiked ? 'red' :
'gray'}-600 text-white py-2 px-4 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                &lt;i
class=&quot;fas fa-heart&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;showComments(${notebook.id})&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                    class=&quot;bg-blue-500
hover:bg-blue-600 text-white py-2 px-4 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                &lt;i
class=&quot;fas fa-comment&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    ` : `</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;text-center text-gray-500&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
&lt;i class=&quot;fas fa-lock mr-2&quot;&gt;&lt;/i&gt;เข้าสู่ระบบเพื่อดาวน์โหลด</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    `}</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            `;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            return card;</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function addNotebook(title,
description, imageUrl, file) {</span></p>

<p class=MsoNormal><span lang=EN>            let finalImageUrl = imageUrl ||
'https://via.placeholder.com/300x200?text=Notebook';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const newNotebook = {</span></p>

<p class=MsoNormal><span lang=EN>                id: Date.now(),</span></p>

<p class=MsoNormal><span lang=EN>                title,</span></p>

<p class=MsoNormal><span lang=EN>                description,</span></p>

<p class=MsoNormal><span lang=EN>                image: finalImageUrl,</span></p>

<p class=MsoNormal><span lang=EN>                uploadDate: new
Date().toISOString(),</span></p>

<p class=MsoNormal><span lang=EN>                likes: 0,</span></p>

<p class=MsoNormal><span lang=EN>                likedBy: [],</span></p>

<p class=MsoNormal><span lang=EN>                comments: [],</span></p>

<p class=MsoNormal><span lang=EN>                file: file,</span></p>

<p class=MsoNormal><span lang=EN>                fileName: file ? file.name :
null</span></p>

<p class=MsoNormal><span lang=EN>            };</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            notebooks.unshift(newNotebook);</span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN>            loadNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>            loadTopNotebooks(); // Refresh top
notebooks</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification('เพิ่มสมุดโน้ตสำเร็จ!');</span></p>

<p class=MsoNormal><span lang=EN>            closeModal('addNotebookModal');</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Clear form</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('addNotebookForm').reset();</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function deleteNotebook(id) {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
if (confirm('คุณแน่ใจหรือไม่ที่จะลบสมุดโน้ตนี้?')) {</span></p>

<p class=MsoNormal><span lang=EN>                notebooks = notebooks.filter(n
=&gt; n.id !== id);</span></p>

<p class=MsoNormal><span lang=EN>                saveData();</span></p>

<p class=MsoNormal><span lang=EN>                loadNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>                loadTopNotebooks(); // Refresh
top notebooks</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('ลบสมุดโน้ตแล้ว');</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function editNotebook(id) {</span></p>

<p class=MsoNormal><span lang=EN>            const notebook = notebooks.find(n
=&gt; n.id === id);</span></p>

<p class=MsoNormal><span lang=EN>            if (!notebook) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Create edit modal</span></p>

<p class=MsoNormal><span lang=EN>            const modal =
document.createElement('div');</span></p>

<p class=MsoNormal><span lang=EN>            modal.id = 'editNotebookModal';</span></p>

<p class=MsoNormal><span lang=EN>            modal.className = 'fixed inset-0
bg-black bg-opacity-50 flex items-center justify-center z-50';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            modal.innerHTML = `</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;bg-white
rounded-xl p-8 max-w-2xl w-full mx-4 slide-up max-h-[90vh]
overflow-y-auto&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;flex
justify-between items-center mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;h2 class=&quot;text-2xl font-bold text-gray-800&quot;&gt;แก้ไขสมุดโน้ต&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;button
onclick=&quot;closeEditModal()&quot; class=&quot;text-gray-500 hover:text-gray-700&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;i
class=&quot;fas fa-times text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;form
id=&quot;editNotebookForm&quot; class=&quot;space-y-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                         
  &lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;หัวข้อสมุดโน้ต&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;input
type=&quot;text&quot; id=&quot;editNotebookTitle&quot;
value=&quot;${notebook.title}&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                                  
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;รายละเอียด&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;textarea
id=&quot;editNotebookDescription&quot; rows=&quot;4&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                                     
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500
focus:border-transparent&quot;&gt;${notebook.description}&lt;/textarea&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;รูปตัวอย่าง
(ลิงค์)&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;input
type=&quot;url&quot; id=&quot;editNotebookImage&quot;
value=&quot;${notebook.image || ''}&quot;
placeholder=&quot;https://example.com/image.jpg&quot;</span></p>

<p class=MsoNormal><span lang=EN>                                  
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
&lt;label class=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;ไฟล์สมุดโน้ตใหม่
(ถ้าต้องการเปลี่ยน)&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;input
type=&quot;file&quot; id=&quot;editNotebookFile&quot;
accept=&quot;.pdf,.doc,.docx,.txt&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                  
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;flex space-x-3&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
type=&quot;button&quot; onclick=&quot;closeEditModal()&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                   
class=&quot;flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 rounded-lg
transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
ยกเลิก</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
type=&quot;submit&quot; class=&quot;flex-1 bg-blue-500 hover:bg-blue-600
text-white py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
&lt;i class=&quot;fas fa-save mr-2&quot;&gt;&lt;/i&gt;บันทึกการแก้ไข</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/form&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            `;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            document.body.appendChild(modal);</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Add event listener for edit
form</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('editNotebookForm').addEventListener('submit',
function(e) {</span></p>

<p class=MsoNormal><span lang=EN>                e.preventDefault();</span></p>

<p class=MsoNormal><span lang=EN>                updateNotebook(id);</span></p>

<p class=MsoNormal><span lang=EN>            });</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function closeEditModal() {</span></p>

<p class=MsoNormal><span lang=EN>            const modal =
document.getElementById('editNotebookModal');</span></p>

<p class=MsoNormal><span lang=EN>            if (modal) {</span></p>

<p class=MsoNormal><span lang=EN>                modal.remove();</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function updateNotebook(id) {</span></p>

<p class=MsoNormal><span lang=EN>            const notebook = notebooks.find(n
=&gt; n.id === id);</span></p>

<p class=MsoNormal><span lang=EN>            if (!notebook) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const title =
document.getElementById('editNotebookTitle').value;</span></p>

<p class=MsoNormal><span lang=EN>            const description =
document.getElementById('editNotebookDescription').value;</span></p>

<p class=MsoNormal><span lang=EN>            const imageUrl =
document.getElementById('editNotebookImage').value;</span></p>

<p class=MsoNormal><span lang=EN>            const fileInput =
document.getElementById('editNotebookFile');</span></p>

<p class=MsoNormal><span lang=EN>            const file = fileInput.files[0];</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Update notebook data</span></p>

<p class=MsoNormal><span lang=EN>            notebook.title = title;</span></p>

<p class=MsoNormal><span lang=EN>            notebook.description = description;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (imageUrl) {</span></p>

<p class=MsoNormal><span lang=EN>                notebook.image = imageUrl;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (file) {</span></p>

<p class=MsoNormal><span lang=EN>                notebook.file = file;</span></p>

<p class=MsoNormal><span lang=EN>                notebook.fileName = file.name;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN>            loadNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>            loadTopNotebooks(); // Refresh top
notebooks</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification('แก้ไขสมุดโน้ตสำเร็จ!');</span></p>

<p class=MsoNormal><span lang=EN>            closeEditModal();</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function toggleLike(id) {</span></p>

<p class=MsoNormal><span lang=EN>            if (!currentUser) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const notebook = notebooks.find(n
=&gt; n.id === id);</span></p>

<p class=MsoNormal><span lang=EN>            if (!notebook) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const userIndex =
notebook.likedBy.indexOf(currentUser.username);</span></p>

<p class=MsoNormal><span lang=EN>            if (userIndex === -1) {</span></p>

<p class=MsoNormal><span lang=EN>               
notebook.likedBy.push(currentUser.username);</span></p>

<p class=MsoNormal><span lang=EN>                notebook.likes++;</span></p>

<p class=MsoNormal><span lang=EN>            } else {</span></p>

<p class=MsoNormal><span lang=EN>                notebook.likedBy.splice(userIndex,
1);</span></p>

<p class=MsoNormal><span lang=EN>                notebook.likes--;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN>            loadNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>            loadTopNotebooks(); // Always
refresh top notebooks</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function downloadNotebook(id) {</span></p>

<p class=MsoNormal><span lang=EN>            const notebook = notebooks.find(n
=&gt; n.id === id);</span></p>

<p class=MsoNormal><span lang=EN>            if (!notebook) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (notebook.file) {</span></p>

<p class=MsoNormal><span lang=EN>                // Create download link for
actual file</span></p>

<p class=MsoNormal><span lang=EN>                const url =
URL.createObjectURL(notebook.file);</span></p>

<p class=MsoNormal><span lang=EN>                const a =
document.createElement('a');</span></p>

<p class=MsoNormal><span lang=EN>                a.href = url;</span></p>

<p class=MsoNormal><span lang=EN>                a.download = notebook.fileName
|| `${notebook.title}.pdf`;</span></p>

<p class=MsoNormal><span lang=EN>                document.body.appendChild(a);</span></p>

<p class=MsoNormal><span lang=EN>                a.click();</span></p>

<p class=MsoNormal><span lang=EN>                document.body.removeChild(a);</span></p>

<p class=MsoNormal><span lang=EN>                URL.revokeObjectURL(url);</span></p>

<p class=MsoNormal><span lang=EN>            } else {</span></p>

<p class=MsoNormal><span lang=EN>                // Create sample PDF content</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                const
content = `สมุดโน้ต:
${notebook.title}\n\n${notebook.description}\n\nดาวน์โหลดเมื่อ: ${new
Date().toLocaleString('th-TH')}`;</span></p>

<p class=MsoNormal><span lang=EN>                const blob = new
Blob([content], { type: 'text/plain' });</span></p>

<p class=MsoNormal><span lang=EN>                const url = URL.createObjectURL(blob);</span></p>

<p class=MsoNormal><span lang=EN>                const a =
document.createElement('a');</span></p>

<p class=MsoNormal><span lang=EN>                a.href = url;</span></p>

<p class=MsoNormal><span lang=EN>                a.download =
`${notebook.title}.txt`;</span></p>

<p class=MsoNormal><span lang=EN>                document.body.appendChild(a);</span></p>

<p class=MsoNormal><span lang=EN>                a.click();</span></p>

<p class=MsoNormal><span lang=EN>                document.body.removeChild(a);</span></p>

<p class=MsoNormal><span lang=EN>                URL.revokeObjectURL(url);</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification('ดาวน์โหลดสำเร็จ!');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function showComments(id) {</span></p>

<p class=MsoNormal><span lang=EN>            const notebook = notebooks.find(n
=&gt; n.id === id);</span></p>

<p class=MsoNormal><span lang=EN>            if (!notebook) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Create comments modal</span></p>

<p class=MsoNormal><span lang=EN>            const modal =
document.createElement('div');</span></p>

<p class=MsoNormal><span lang=EN>            modal.id = 'commentsModal';</span></p>

<p class=MsoNormal><span lang=EN>            modal.className = 'fixed inset-0
bg-black bg-opacity-50 flex items-center justify-center z-50';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            modal.innerHTML = `</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;bg-white
rounded-xl p-8 max-w-2xl w-full mx-4 slide-up max-h-[90vh]
overflow-y-auto&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;flex
justify-between items-center mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;h2 class=&quot;text-2xl font-bold text-gray-800&quot;&gt;ความคิดเห็น -
${notebook.title}&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;button
onclick=&quot;closeCommentsModal()&quot; class=&quot;text-gray-500
hover:text-gray-700&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;i
class=&quot;fas fa-times text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    </span></p>

<p class=MsoNormal><span lang=EN>                    &lt;!-- Add Comment Form
--&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;mb-6
p-4 bg-gray-50 rounded-lg&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;textarea id=&quot;newComment&quot; placeholder=&quot;แสดงความคิดเห็น...&quot;
rows=&quot;3&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                 
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;&lt;/textarea&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;button
onclick=&quot;addComment(${id})&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                class=&quot;mt-3
bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg
transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
&lt;i class=&quot;fas fa-comment mr-2&quot;&gt;&lt;/i&gt;ส่งความคิดเห็น</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    </span></p>

<p class=MsoNormal><span lang=EN>                    &lt;!-- Comments List
--&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
id=&quot;commentsList&quot; class=&quot;space-y-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                       
${notebook.comments.map(comment =&gt; `</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;div
class=&quot;bg-gray-50 rounded-lg p-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                &lt;div
class=&quot;flex justify-between items-start mb-2&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                   
&lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                        &lt;h4
class=&quot;font-semibold text-gray-800&quot;&gt;${comment.userName}&lt;/h4&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                        &lt;p class=&quot;text-sm
text-gray-600&quot;&gt;${new
Date(comment.timestamp).toLocaleString('th-TH')}&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                   
&lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                &lt;p
class=&quot;text-gray-700&quot;&gt;${comment.content}&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        `).join('')}</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            `;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            document.body.appendChild(modal);</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function closeCommentsModal() {</span></p>

<p class=MsoNormal><span lang=EN>            const modal =
document.getElementById('commentsModal');</span></p>

<p class=MsoNormal><span lang=EN>            if (modal) {</span></p>

<p class=MsoNormal><span lang=EN>                modal.remove();</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function addComment(notebookId) {</span></p>

<p class=MsoNormal><span lang=EN>            if (!currentUser) {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('กรุณาเข้าสู่ระบบก่อนแสดงความคิดเห็น', 'error');</span></p>

<p class=MsoNormal><span lang=EN>                return;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const commentText =
document.getElementById('newComment').value.trim();</span></p>

<p class=MsoNormal><span lang=EN>            if (!commentText) {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('กรุณาใส่ความคิดเห็น', 'error');</span></p>

<p class=MsoNormal><span lang=EN>                return;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const notebook = notebooks.find(n
=&gt; n.id === notebookId);</span></p>

<p class=MsoNormal><span lang=EN>            if (!notebook) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const comment = {</span></p>

<p class=MsoNormal><span lang=EN>                id: Date.now(),</span></p>

<p class=MsoNormal><span lang=EN>                userName:
currentUser.displayName,</span></p>

<p class=MsoNormal><span lang=EN>                userUsername:
currentUser.username,</span></p>

<p class=MsoNormal><span lang=EN>                content: commentText,</span></p>

<p class=MsoNormal><span lang=EN>                timestamp: new
Date().toISOString()</span></p>

<p class=MsoNormal><span lang=EN>            };</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            notebook.comments.push(comment);</span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Send notification to admin</span></p>

<p class=MsoNormal><span lang=EN>            if (!isAdmin) {</span></p>

<p class=MsoNormal><span lang=EN>                const message = {</span></p>

<p class=MsoNormal><span lang=EN>                    id: Date.now() +
Math.random(),</span></p>

<p class=MsoNormal><span lang=EN>                    from:
currentUser.username,</span></p>

<p class=MsoNormal><span lang=EN>                    fromName:
currentUser.displayName,</span></p>

<p class=MsoNormal><span lang=EN>                    to: 'admin',</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
subject: `ความคิดเห็นใหม่ในสมุดโน้ต: ${notebook.title}`,</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
content: `${currentUser.displayName} ได้แสดงความคิดเห็น:
&quot;${commentText}&quot;`,</span></p>

<p class=MsoNormal><span lang=EN>                    timestamp: new
Date().toISOString(),</span></p>

<p class=MsoNormal><span lang=EN>                    read: false,</span></p>

<p class=MsoNormal><span lang=EN>                    replies: []</span></p>

<p class=MsoNormal><span lang=EN>                };</span></p>

<p class=MsoNormal><span lang=EN>                messages.push(message);</span></p>

<p class=MsoNormal><span lang=EN>                saveData();</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification('ส่งความคิดเห็นสำเร็จ!');</span></p>

<p class=MsoNormal><span lang=EN>            closeCommentsModal();</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function searchNotebooks() {</span></p>

<p class=MsoNormal><span lang=EN>            const searchTerm =
document.getElementById('searchInput').value.toLowerCase();</span></p>

<p class=MsoNormal><span lang=EN>            const filteredNotebooks =
notebooks.filter(notebook =&gt; </span></p>

<p class=MsoNormal><span lang=EN>               
notebook.title.toLowerCase().includes(searchTerm) || </span></p>

<p class=MsoNormal><span lang=EN>               
notebook.description.toLowerCase().includes(searchTerm)</span></p>

<p class=MsoNormal><span lang=EN>            );</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const notebooksList =
document.getElementById('notebooksList');</span></p>

<p class=MsoNormal><span lang=EN>            notebooksList.innerHTML = '';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            filteredNotebooks.forEach(notebook
=&gt; {</span></p>

<p class=MsoNormal><span lang=EN>                const notebookCard =
createNotebookCard(notebook);</span></p>

<p class=MsoNormal><span lang=EN>                notebooksList.appendChild(notebookCard);</span></p>

<p class=MsoNormal><span lang=EN>            });</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Message functions</span></p>

<p class=MsoNormal><span lang=EN>        function sendMessage(subject, content,
recipient = 'admin') {</span></p>

<p class=MsoNormal><span lang=EN>            const message = {</span></p>

<p class=MsoNormal><span lang=EN>                id: Date.now(),</span></p>

<p class=MsoNormal><span lang=EN>                from: currentUser.username,</span></p>

<p class=MsoNormal><span lang=EN>                fromName:
currentUser.displayName,</span></p>

<p class=MsoNormal><span lang=EN>                to: recipient,</span></p>

<p class=MsoNormal><span lang=EN>                subject,</span></p>

<p class=MsoNormal><span lang=EN>                content,</span></p>

<p class=MsoNormal><span lang=EN>                timestamp: new
Date().toISOString(),</span></p>

<p class=MsoNormal><span lang=EN>                read: false,</span></p>

<p class=MsoNormal><span lang=EN>                replies: []</span></p>

<p class=MsoNormal><span lang=EN>            };</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            messages.push(message);</span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Update message count for all
users (including admin)</span></p>

<p class=MsoNormal><span lang=EN>            updateMessageCount();</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Send email notification
(simulated)</span></p>

<p class=MsoNormal><span lang=EN>            if (recipient === 'admin') {</span></p>

<p class=MsoNormal><span lang=EN>                console.log(`Email sent to:
mongkhonchatchawan.n@gmail.com`);</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
console.log(`Subject: ข้อเสนอแนะจากผู้ใช้ NoTeBooK - ${subject}`);</span></p>

<p class=MsoNormal><span lang=EN>                console.log(`Content:
${content}`);</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function sendAnnouncement(title,
content) {</span></p>

<p class=MsoNormal><span lang=EN>            // Send to all users</span></p>

<p class=MsoNormal><span lang=EN>            users.forEach(user =&gt; {</span></p>

<p class=MsoNormal><span lang=EN>                const message = {</span></p>

<p class=MsoNormal><span lang=EN>                    id: Date.now() +
Math.random(),</span></p>

<p class=MsoNormal><span lang=EN>                    from: 'admin',</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
fromName: 'ผู้ดูแลระบบ',</span></p>

<p class=MsoNormal><span lang=EN>                    to: user.username,</span></p>

<p class=MsoNormal><span lang=EN>                    subject: title,</span></p>

<p class=MsoNormal><span lang=EN>                    content,</span></p>

<p class=MsoNormal><span lang=EN>                    timestamp: new Date().toISOString(),</span></p>

<p class=MsoNormal><span lang=EN>                    read: false,</span></p>

<p class=MsoNormal><span lang=EN>                    isAnnouncement: true,</span></p>

<p class=MsoNormal><span lang=EN>                    replies: []</span></p>

<p class=MsoNormal><span lang=EN>                };</span></p>

<p class=MsoNormal><span lang=EN>                messages.push(message);</span></p>

<p class=MsoNormal><span lang=EN>                </span></p>

<p class=MsoNormal><span lang=EN>                // Send email notification
(simulated)</span></p>

<p class=MsoNormal><span lang=EN>                console.log(`Email sent to:
${user.email}`);</span></p>

<p class=MsoNormal><span lang=EN>                console.log(`From:
mongkhonchatchawan.n@gmail.com`);</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
console.log(`Subject: ประกาศจากแอดมินเว็บ NoTeBooK - ${title}`);</span></p>

<p class=MsoNormal><span lang=EN>                console.log(`Content:
${content}`);</span></p>

<p class=MsoNormal><span lang=EN>            });</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Also send to admin's own
message box for record keeping</span></p>

<p class=MsoNormal><span lang=EN>            const adminMessage = {</span></p>

<p class=MsoNormal><span lang=EN>                id: Date.now() + Math.random()
+ 1,</span></p>

<p class=MsoNormal><span lang=EN>                from: 'admin',</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
fromName: 'ผู้ดูแลระบบ',</span></p>

<p class=MsoNormal><span lang=EN>                to: 'admin',</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
subject: `[บันทึก] ประกาศที่ส่งแล้ว: ${title}`,</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
content: `ประกาศนี้ถูกส่งไปยังผู้ใช้ทั้งหมด ${users.length}
คน\n\nเนื้อหาประกาศ:\n${content}`,</span></p>

<p class=MsoNormal><span lang=EN>                timestamp: new
Date().toISOString(),</span></p>

<p class=MsoNormal><span lang=EN>                read: false,</span></p>

<p class=MsoNormal><span lang=EN>                isAnnouncement: true,</span></p>

<p class=MsoNormal><span lang=EN>                isSentRecord: true,</span></p>

<p class=MsoNormal><span lang=EN>                replies: []</span></p>

<p class=MsoNormal><span lang=EN>            };</span></p>

<p class=MsoNormal><span lang=EN>            messages.push(adminMessage);</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN>            updateMessageCount();</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification(`ส่งประกาศสำเร็จไปยัง ${users.length} ผู้ใช้!`);</span></p>

<p class=MsoNormal><span lang=EN>            closeModal('announcementModal');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function loadMessages() {</span></p>

<p class=MsoNormal><span lang=EN>            const messagesList =
document.getElementById('messagesList');</span></p>

<p class=MsoNormal><span lang=EN>            messagesList.innerHTML = '';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            let userMessages;</span></p>

<p class=MsoNormal><span lang=EN>            if (isAdmin) {</span></p>

<p class=MsoNormal><span lang=EN>                // Admin sees all messages
sent to admin and messages sent by admin</span></p>

<p class=MsoNormal><span lang=EN>                userMessages =
messages.filter(m =&gt; m.to === 'admin' || m.from === 'admin');</span></p>

<p class=MsoNormal><span lang=EN>            } else {</span></p>

<p class=MsoNormal><span lang=EN>                // Regular users see messages
sent to them and messages sent by them</span></p>

<p class=MsoNormal><span lang=EN>                userMessages =
messages.filter(m =&gt; m.to === currentUser.username || m.from ===
currentUser.username);</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            userMessages.sort((a, b) =&gt; new
Date(b.timestamp) - new Date(a.timestamp));</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            userMessages.forEach(message =&gt;
{</span></p>

<p class=MsoNormal><span lang=EN>                const messageCard =
createMessageCard(message);</span></p>

<p class=MsoNormal><span lang=EN>               
messagesList.appendChild(messageCard);</span></p>

<p class=MsoNormal><span lang=EN>            });</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Mark messages as read when
viewing</span></p>

<p class=MsoNormal><span lang=EN>            userMessages.forEach(message =&gt;
{</span></p>

<p class=MsoNormal><span lang=EN>                if ((isAdmin &amp;&amp;
message.to === 'admin') || (!isAdmin &amp;&amp; message.to ===
currentUser.username)) {</span></p>

<p class=MsoNormal><span lang=EN>                    message.read = true;</span></p>

<p class=MsoNormal><span lang=EN>                }</span></p>

<p class=MsoNormal><span lang=EN>            });</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN>            updateMessageCount();</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function createMessageCard(message) {</span></p>

<p class=MsoNormal><span lang=EN>            const card =
document.createElement('div');</span></p>

<p class=MsoNormal><span lang=EN>            card.className = `bg-gray-50
rounded-lg p-4 ${!message.read ? 'border-l-4 border-blue-500' : ''}`;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            let badgeHtml = '';</span></p>

<p class=MsoNormal><span lang=EN>            if (message.isAnnouncement
&amp;&amp; message.isSentRecord) {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
badgeHtml = '&lt;span class=&quot;bg-green-500 text-white px-2 py-1 rounded
text-xs&quot;&gt;บันทึกประกาศ&lt;/span&gt;';</span></p>

<p class=MsoNormal><span lang=EN>            } else if (message.isAnnouncement)
{</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
badgeHtml = '&lt;span class=&quot;bg-blue-500 text-white px-2 py-1 rounded
text-xs&quot;&gt;ประกาศ&lt;/span&gt;';</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            card.innerHTML = `</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;flex
justify-between items-start mb-2&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;h4
class=&quot;font-semibold text-gray-800&quot;&gt;${message.subject}&lt;/h4&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;p class=&quot;text-sm text-gray-600&quot;&gt;จาก: ${message.fromName} |
${new Date(message.timestamp).toLocaleString('th-TH')}&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    ${badgeHtml}</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;p
class=&quot;text-gray-700 mb-3
whitespace-pre-line&quot;&gt;${message.content}&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;flex
space-x-2&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    ${isAdmin &amp;&amp;
message.to === 'admin' &amp;&amp; !message.isSentRecord ? `</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;button onclick=&quot;replyToMessage(${message.id})&quot;
</span></p>

<p class=MsoNormal><span lang=EN>                               
class=&quot;bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg
text-sm transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
&lt;i class=&quot;fas fa-reply mr-2&quot;&gt;&lt;/i&gt;ตอบกลับ</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    ` : ''}</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;button
onclick=&quot;deleteMessage(${message.id})&quot; </span></p>

<p class=MsoNormal><span lang=EN>                           
class=&quot;bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm
transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;i class=&quot;fas fa-trash mr-2&quot;&gt;&lt;/i&gt;ลบ</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            `;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            return card;</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function updateMessageCount() {</span></p>

<p class=MsoNormal><span lang=EN>            if (!currentUser) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            let unreadCount;</span></p>

<p class=MsoNormal><span lang=EN>            if (isAdmin) {</span></p>

<p class=MsoNormal><span lang=EN>                // Admin counts unread
messages sent to admin</span></p>

<p class=MsoNormal><span lang=EN>                unreadCount =
messages.filter(m =&gt; m.to === 'admin' &amp;&amp; !m.read).length;</span></p>

<p class=MsoNormal><span lang=EN>            } else {</span></p>

<p class=MsoNormal><span lang=EN>                // Regular users count unread
messages sent to them</span></p>

<p class=MsoNormal><span lang=EN>                unreadCount =
messages.filter(m =&gt; m.to === currentUser.username &amp;&amp;
!m.read).length;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const messageCount =
document.getElementById('messageCount');</span></p>

<p class=MsoNormal><span lang=EN>            if (unreadCount &gt; 0) {</span></p>

<p class=MsoNormal><span lang=EN>                messageCount.textContent =
unreadCount;</span></p>

<p class=MsoNormal><span lang=EN>               
messageCount.classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            } else {</span></p>

<p class=MsoNormal><span lang=EN>               
messageCount.classList.add('hidden');</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function replyToMessage(messageId) {</span></p>

<p class=MsoNormal><span lang=EN>            const message = messages.find(m
=&gt; m.id === messageId);</span></p>

<p class=MsoNormal><span lang=EN>            if (!message) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Create reply modal</span></p>

<p class=MsoNormal><span lang=EN>            const modal =
document.createElement('div');</span></p>

<p class=MsoNormal><span lang=EN>            modal.id = 'replyModal';</span></p>

<p class=MsoNormal><span lang=EN>            modal.className = 'fixed inset-0
bg-black bg-opacity-50 flex items-center justify-center z-50';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            modal.innerHTML = `</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;bg-white
rounded-xl p-8 max-w-md w-full mx-4 slide-up&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;flex
justify-between items-center mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;h2 class=&quot;text-2xl font-bold text-gray-800&quot;&gt;ตอบกลับข้อความ&lt;/h2&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;button
onclick=&quot;closeReplyModal()&quot; class=&quot;text-gray-500
hover:text-gray-700&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;i
class=&quot;fas fa-times text-xl&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;mb-4 p-4
bg-gray-50 rounded-lg&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;h4 class=&quot;font-semibold text-gray-800 mb-2&quot;&gt;ข้อความต้นฉบับ:&lt;/h4&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;p class=&quot;text-sm text-gray-600 mb-2&quot;&gt;จาก:
${message.fromName}&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;p class=&quot;text-sm text-gray-600 mb-2&quot;&gt;หัวข้อ:
${message.subject}&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;p
class=&quot;text-gray-700&quot;&gt;${message.content}&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;form
id=&quot;replyForm&quot; class=&quot;space-y-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                    
       &lt;label class=&quot;block text-sm font-medium text-gray-700
mb-2&quot;&gt;การตอบกลับ&lt;/label&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;textarea
id=&quot;replyContent&quot; rows=&quot;6&quot; required </span></p>

<p class=MsoNormal><span lang=EN>                                     
class=&quot;w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2
focus:ring-purple-500 focus:border-transparent&quot;&gt;&lt;/textarea&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;flex space-x-3&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
type=&quot;button&quot; onclick=&quot;closeReplyModal()&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                   
class=&quot;flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 rounded-lg
transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
ยกเลิก</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
type=&quot;submit&quot; class=&quot;flex-1 bg-blue-500 hover:bg-blue-600
text-white py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
&lt;i class=&quot;fas fa-reply mr-2&quot;&gt;&lt;/i&gt;ส่งการตอบกลับ</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/form&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>            `;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            document.body.appendChild(modal);</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Add event listener for reply
form</span></p>

<p class=MsoNormal><span lang=EN>            document.getElementById('replyForm').addEventListener('submit',
function(e) {</span></p>

<p class=MsoNormal><span lang=EN>                e.preventDefault();</span></p>

<p class=MsoNormal><span lang=EN>                sendReply(messageId);</span></p>

<p class=MsoNormal><span lang=EN>            });</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function closeReplyModal() {</span></p>

<p class=MsoNormal><span lang=EN>            const modal = document.getElementById('replyModal');</span></p>

<p class=MsoNormal><span lang=EN>            if (modal) {</span></p>

<p class=MsoNormal><span lang=EN>                modal.remove();</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function sendReply(originalMessageId)
{</span></p>

<p class=MsoNormal><span lang=EN>            const originalMessage =
messages.find(m =&gt; m.id === originalMessageId);</span></p>

<p class=MsoNormal><span lang=EN>            if (!originalMessage) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const replyContent =
document.getElementById('replyContent').value.trim();</span></p>

<p class=MsoNormal><span lang=EN>            if (!replyContent) {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('กรุณาใส่เนื้อหาการตอบกลับ', 'error');</span></p>

<p class=MsoNormal><span lang=EN>                return;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Create reply message</span></p>

<p class=MsoNormal><span lang=EN>            const replyMessage = {</span></p>

<p class=MsoNormal><span lang=EN>                id: Date.now(),</span></p>

<p class=MsoNormal><span lang=EN>                from: 'admin',</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
fromName: 'ผู้ดูแลระบบ',</span></p>

<p class=MsoNormal><span lang=EN>                to: originalMessage.from,</span></p>

<p class=MsoNormal><span lang=EN>                subject: `Re:
${originalMessage.subject}`,</span></p>

<p class=MsoNormal><span lang=EN>                content: replyContent,</span></p>

<p class=MsoNormal><span lang=EN>                timestamp: new
Date().toISOString(),</span></p>

<p class=MsoNormal><span lang=EN>                read: false,</span></p>

<p class=MsoNormal><span lang=EN>                isReply: true,</span></p>

<p class=MsoNormal><span lang=EN>                originalMessageId:
originalMessageId,</span></p>

<p class=MsoNormal><span lang=EN>                replies: []</span></p>

<p class=MsoNormal><span lang=EN>            };</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            messages.push(replyMessage);</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Mark original message as read</span></p>

<p class=MsoNormal><span lang=EN>            originalMessage.read = true;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN>            updateMessageCount();</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Send email notification
(simulated)</span></p>

<p class=MsoNormal><span lang=EN>            const originalUser = users.find(u
=&gt; u.username === originalMessage.from);</span></p>

<p class=MsoNormal><span lang=EN>            if (originalUser) {</span></p>

<p class=MsoNormal><span lang=EN>                console.log(`Email sent to:
${originalUser.email}`);</span></p>

<p class=MsoNormal><span lang=EN>                console.log(`From:
mongkhonchatchawan.n@gmail.com`);</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
console.log(`Subject: การตอบกลับจากแอดมินเว็บ NoTeBooK - Re:
${originalMessage.subject}`);</span></p>

<p class=MsoNormal><span lang=EN>                console.log(`Content:
${replyContent}`);</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification('ส่งการตอบกลับสำเร็จ!');</span></p>

<p class=MsoNormal><span lang=EN>            closeReplyModal();</span></p>

<p class=MsoNormal><span lang=EN>            loadMessages(); // Refresh
messages</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function deleteMessage(messageId) {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
if (confirm('คุณแน่ใจหรือไม่ที่จะลบข้อความนี้?')) {</span></p>

<p class=MsoNormal><span lang=EN>                const messageToDelete =
messages.find(m =&gt; m.id === messageId);</span></p>

<p class=MsoNormal><span lang=EN>                </span></p>

<p class=MsoNormal><span lang=EN>                // Check if user has
permission to delete this message</span></p>

<p class=MsoNormal><span lang=EN>                if (messageToDelete &amp;&amp;
(</span></p>

<p class=MsoNormal><span lang=EN>                    isAdmin || // Admin can
delete any message</span></p>

<p class=MsoNormal><span lang=EN>                    messageToDelete.from ===
currentUser.username || // User can delete their own sent messages</span></p>

<p class=MsoNormal><span lang=EN>                    messageToDelete.to ===
currentUser.username // User can delete messages sent to them</span></p>

<p class=MsoNormal><span lang=EN>                )) {</span></p>

<p class=MsoNormal><span lang=EN>                    messages =
messages.filter(m =&gt; m.id !== messageId);</span></p>

<p class=MsoNormal><span lang=EN>                    saveData();</span></p>

<p class=MsoNormal><span lang=EN>                    updateMessageCount();</span></p>

<p class=MsoNormal><span lang=EN>                    loadMessages(); // Refresh
messages</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
showNotification('ลบข้อความแล้ว');</span></p>

<p class=MsoNormal><span lang=EN>                } else {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                   
showNotification('คุณไม่มีสิทธิ์ลบข้อความนี้', 'error');</span></p>

<p class=MsoNormal><span lang=EN>                }</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Event listeners</span></p>

<p class=MsoNormal><span lang=EN>        document.getElementById('loginForm').addEventListener('submit',
function(e) {</span></p>

<p class=MsoNormal><span lang=EN>            e.preventDefault();</span></p>

<p class=MsoNormal><span lang=EN>            const username =
document.getElementById('loginUsername').value;</span></p>

<p class=MsoNormal><span lang=EN>            const password =
document.getElementById('loginPassword').value;</span></p>

<p class=MsoNormal><span lang=EN>            login(username, password);</span></p>

<p class=MsoNormal><span lang=EN>        });</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>       
document.getElementById('registerForm').addEventListener('submit', function(e)
{</span></p>

<p class=MsoNormal><span lang=EN>            e.preventDefault();</span></p>

<p class=MsoNormal><span lang=EN>            const displayName =
document.getElementById('registerDisplayName').value;</span></p>

<p class=MsoNormal><span lang=EN>            const username =
document.getElementById('registerUsername').value;</span></p>

<p class=MsoNormal><span lang=EN>            const email =
document.getElementById('registerEmail').value;</span></p>

<p class=MsoNormal><span lang=EN>            const password =
document.getElementById('registerPassword').value;</span></p>

<p class=MsoNormal><span lang=EN>            const confirmPassword =
document.getElementById('registerConfirmPassword').value;</span></p>

<p class=MsoNormal><span lang=EN>            register(displayName, username,
email, password, confirmPassword);</span></p>

<p class=MsoNormal><span lang=EN>        });</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>       
document.getElementById('addNotebookForm').addEventListener('submit',
function(e) {</span></p>

<p class=MsoNormal><span lang=EN>            e.preventDefault();</span></p>

<p class=MsoNormal><span lang=EN>            const title =
document.getElementById('notebookTitle').value;</span></p>

<p class=MsoNormal><span lang=EN>            const description =
document.getElementById('notebookDescription').value;</span></p>

<p class=MsoNormal><span lang=EN>            const imageUrl =
document.getElementById('notebookImage').value;</span></p>

<p class=MsoNormal><span lang=EN>            const fileInput =
document.getElementById('notebookFile');</span></p>

<p class=MsoNormal><span lang=EN>            const file = fileInput.files[0];</span></p>

<p class=MsoNormal><span lang=EN>            addNotebook(title, description,
imageUrl, file);</span></p>

<p class=MsoNormal><span lang=EN>        });</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>       
document.getElementById('feedbackForm').addEventListener('submit', function(e)
{</span></p>

<p class=MsoNormal><span lang=EN>            e.preventDefault();</span></p>

<p class=MsoNormal><span lang=EN>            if (!currentUser) {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('กรุณาเข้าสู่ระบบก่อนส่งข้อเสนอแนะ', 'error');</span></p>

<p class=MsoNormal><span lang=EN>                return;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            const subject =
document.getElementById('feedbackSubject').value;</span></p>

<p class=MsoNormal><span lang=EN>            const content =
document.getElementById('feedbackMessage').value;</span></p>

<p class=MsoNormal><span lang=EN>            sendMessage(subject, content);</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification('ส่งข้อเสนอแนะสำเร็จ!');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('feedbackForm').reset();</span></p>

<p class=MsoNormal><span lang=EN>        });</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>       
document.getElementById('announcementForm').addEventListener('submit',
function(e) {</span></p>

<p class=MsoNormal><span lang=EN>            e.preventDefault();</span></p>

<p class=MsoNormal><span lang=EN>            const title =
document.getElementById('announcementTitle').value;</span></p>

<p class=MsoNormal><span lang=EN>            const content =
document.getElementById('announcementContent').value;</span></p>

<p class=MsoNormal><span lang=EN>            sendAnnouncement(title, content);</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('announcementForm').reset();</span></p>

<p class=MsoNormal><span lang=EN>        });</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>       
document.getElementById('searchInput').addEventListener('keypress', function(e)
{</span></p>

<p class=MsoNormal><span lang=EN>            if (e.key === 'Enter') {</span></p>

<p class=MsoNormal><span lang=EN>                searchNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        });</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>       
document.getElementById('questionForm').addEventListener('submit', function(e)
{</span></p>

<p class=MsoNormal><span lang=EN>            e.preventDefault();</span></p>

<p class=MsoNormal><span lang=EN>            const questionText =
document.getElementById('questionText').value;</span></p>

<p class=MsoNormal><span lang=EN>            const options = {</span></p>

<p class=MsoNormal><span lang=EN>                A:
document.getElementById('optionA').value,</span></p>

<p class=MsoNormal><span lang=EN>                B: document.getElementById('optionB').value,</span></p>

<p class=MsoNormal><span lang=EN>                C:
document.getElementById('optionC').value,</span></p>

<p class=MsoNormal><span lang=EN>                D:
document.getElementById('optionD').value</span></p>

<p class=MsoNormal><span lang=EN>            };</span></p>

<p class=MsoNormal><span lang=EN>            const correctAnswer =
document.getElementById('correctAnswer').value;</span></p>

<p class=MsoNormal><span lang=EN>            const explanation =
document.getElementById('explanation').value;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const editId =
this.dataset.editId;</span></p>

<p class=MsoNormal><span lang=EN>            if (editId) {</span></p>

<p class=MsoNormal><span lang=EN>               
updateQuestion(parseInt(editId), questionText, options, correctAnswer,
explanation);</span></p>

<p class=MsoNormal><span lang=EN>            } else {</span></p>

<p class=MsoNormal><span lang=EN>                addQuestion(questionText,
options, correctAnswer, explanation);</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        });</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Question functions</span></p>

<p class=MsoNormal><span lang=EN>        function loadQuestions() {</span></p>

<p class=MsoNormal><span lang=EN>            const quizSection =
document.getElementById('quizSection');</span></p>

<p class=MsoNormal><span lang=EN>            quizSection.innerHTML = '';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (questions.length === 0) {</span></p>

<p class=MsoNormal><span lang=EN>                quizSection.innerHTML = `</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;text-center py-12&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;text-gray-400 text-6xl mb-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;i
class=&quot;fas fa-question-circle&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;p class=&quot;text-gray-600 text-lg&quot;&gt;ยังไม่มีคำถามในระบบ&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
${isAdmin ? '&lt;p class=&quot;text-gray-500&quot;&gt;คลิก
&quot;จัดการคำถาม&quot; เพื่อเพิ่มคำถามใหม่&lt;/p&gt;' : '&lt;p
class=&quot;text-gray-500&quot;&gt;รอสักครู่เพื่อดูคำถามใหม่ๆ&lt;/p&gt;'}</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                `;</span></p>

<p class=MsoNormal><span lang=EN>                return;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Show random question</span></p>

<p class=MsoNormal><span lang=EN>            const randomQuestion =
questions[Math.floor(Math.random() * questions.length)];</span></p>

<p class=MsoNormal><span lang=EN>            const questionCard =
createQuestionCard(randomQuestion);</span></p>

<p class=MsoNormal><span lang=EN>            quizSection.appendChild(questionCard);</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function createQuestionCard(question)
{</span></p>

<p class=MsoNormal><span lang=EN>            const card =
document.createElement('div');</span></p>

<p class=MsoNormal><span lang=EN>            card.className = 'bg-white
rounded-xl shadow-lg p-8';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const userAnswer =
getUserAnswer(question.id);</span></p>

<p class=MsoNormal><span lang=EN>            const hasAnswered = userAnswer !==
null;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            card.innerHTML = `</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div
class=&quot;mb-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;h3 class=&quot;text-xl
font-semibold text-gray-800 mb-4&quot;&gt;${question.question}&lt;/h3&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;space-y-3&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        ${['A', 'B', 'C',
'D'].map(option =&gt; `</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;selectAnswer(${question.id}, '${option}')&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                   
class=&quot;w-full text-left p-4 rounded-lg border-2 transition-all ${</span></p>

<p class=MsoNormal><span lang=EN>                                       
hasAnswered </span></p>

<p class=MsoNormal><span lang=EN>                                            ?
(option === question.correctAnswer </span></p>

<p class=MsoNormal><span lang=EN>                                               
? 'border-green-500 bg-green-50 text-green-800' </span></p>

<p class=MsoNormal><span lang=EN>                                               
: (option === userAnswer </span></p>

<p class=MsoNormal><span lang=EN>                                                   
? 'border-red-500 bg-red-50 text-red-800' </span></p>

<p class=MsoNormal><span lang=EN>                                                   
: 'border-gray-200 bg-gray-50 text-gray-600'))</span></p>

<p class=MsoNormal><span lang=EN>                                            :
'border-gray-200 hover:border-purple-500 hover:bg-purple-50'</span></p>

<p class=MsoNormal><span lang=EN>                                    }
${hasAnswered ? 'cursor-not-allowed' : 'cursor-pointer'}&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                &lt;span
class=&quot;font-semibold mr-3&quot;&gt;${option}.&lt;/span&gt;</span></p>

<p class=MsoNormal><span lang=EN>                               
${question.options[option]}</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
${hasAnswered &amp;&amp; option === question.correctAnswer ? ' ✓' : ''}</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
${hasAnswered &amp;&amp; option === userAnswer &amp;&amp; option !==
question.correctAnswer ? ' ✗' : ''}</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        `).join('')}</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                </span></p>

<p class=MsoNormal><span lang=EN>                ${hasAnswered ? `</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;border-t pt-6&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;mb-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
&lt;h4 class=&quot;font-semibold text-gray-800 mb-2&quot;&gt;สถิติการตอบ:&lt;/h4&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;div
class=&quot;grid grid-cols-2 md:grid-cols-4 gap-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                ${['A', 'B',
'C', 'D'].map(option =&gt; {</span></p>

<p class=MsoNormal><span lang=EN>                                    const
count = question.answers.filter(a =&gt; a.answer === option).length;</span></p>

<p class=MsoNormal><span lang=EN>                                    const
percentage = question.answers.length &gt; 0 ? Math.round((count /
question.answers.length) * 100) : 0;</span></p>

<p class=MsoNormal><span lang=EN>                                    return `</span></p>

<p class=MsoNormal><span lang=EN>                                       
&lt;div class=&quot;text-center p-3 rounded-lg ${option ===
question.correctAnswer ? 'bg-green-100' : 'bg-gray-100'}&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                           
&lt;div class=&quot;text-2xl font-bold ${option === question.correctAnswer ?
'text-green-600' : 'text-gray-600'}&quot;&gt;${percentage}%&lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                                           
&lt;div class=&quot;text-sm text-gray-600&quot;&gt;ตัวเลือก
${option}&lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                       
&lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                    `;</span></p>

<p class=MsoNormal><span lang=EN>                                }).join('')}</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        </span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;bg-blue-50 p-4 rounded-lg&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
&lt;h4 class=&quot;font-semibold text-blue-800 mb-2&quot;&gt;คำตอบที่ถูกต้อง:
${question.correctAnswer}&lt;/h4&gt;</span></p>

<p class=MsoNormal><span lang=EN>                           
${question.explanation ? `&lt;p
class=&quot;text-blue-700&quot;&gt;${question.explanation}&lt;/p&gt;` : ''}</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        </span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;mt-4 text-center&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;loadQuestions()&quot; class=&quot;bg-purple-600
hover:bg-purple-700 text-white px-6 py-2 rounded-lg transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                               
&lt;i class=&quot;fas fa-refresh mr-2&quot;&gt;&lt;/i&gt;คำถามถัดไป</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                ` : `</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;text-center text-gray-500&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
${currentUser ? 'เลือกคำตอบของคุณ' : 'เข้าสู่ระบบเพื่อตอบคำถาม'}</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                `}</span></p>

<p class=MsoNormal><span lang=EN>            `;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            return card;</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function selectAnswer(questionId,
answer) {</span></p>

<p class=MsoNormal><span lang=EN>            if (!currentUser) {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('กรุณาเข้าสู่ระบบก่อนตอบคำถาม', 'error');</span></p>

<p class=MsoNormal><span lang=EN>                return;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const question = questions.find(q =&gt;
q.id === questionId);</span></p>

<p class=MsoNormal><span lang=EN>            if (!question) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Check if user already answered</span></p>

<p class=MsoNormal><span lang=EN>            const existingAnswer =
question.answers.find(a =&gt; a.username === currentUser.username);</span></p>

<p class=MsoNormal><span lang=EN>            if (existingAnswer) {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('คุณได้ตอบคำถามนี้แล้ว', 'error');</span></p>

<p class=MsoNormal><span lang=EN>                return;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Add user's answer</span></p>

<p class=MsoNormal><span lang=EN>            question.answers.push({</span></p>

<p class=MsoNormal><span lang=EN>                username:
currentUser.username,</span></p>

<p class=MsoNormal><span lang=EN>                answer: answer,</span></p>

<p class=MsoNormal><span lang=EN>                timestamp: new
Date().toISOString()</span></p>

<p class=MsoNormal><span lang=EN>            });</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN>            loadQuestions(); // Reload to show
results</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const isCorrect = answer ===
question.correctAnswer;</span></p>

<p class=MsoNormal><span lang=EN>            showNotification(isCorrect ? 'ตอบถูกต้อง!
&#127881;' : 'ตอบผิด แต่ไม่เป็นไร ลองใหม่ในคำถามถัดไป! &#128170;');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function getUserAnswer(questionId) {</span></p>

<p class=MsoNormal><span lang=EN>            if (!currentUser) return null;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const question = questions.find(q
=&gt; q.id === questionId);</span></p>

<p class=MsoNormal><span lang=EN>            if (!question) return null;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const userAnswer =
question.answers.find(a =&gt; a.username === currentUser.username);</span></p>

<p class=MsoNormal><span lang=EN>            return userAnswer ?
userAnswer.answer : null;</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function loadQuestionsForManagement()
{</span></p>

<p class=MsoNormal><span lang=EN>            const questionsList =
document.getElementById('questionsList');</span></p>

<p class=MsoNormal><span lang=EN>            questionsList.innerHTML = '';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            if (questions.length === 0) {</span></p>

<p class=MsoNormal><span lang=EN>                questionsList.innerHTML = `</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div
class=&quot;text-center py-8&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;text-gray-400 text-4xl mb-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;i
class=&quot;fas fa-question-circle&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;p class=&quot;text-gray-600&quot;&gt;ยังไม่มีคำถามในระบบ&lt;/p&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                `;</span></p>

<p class=MsoNormal><span lang=EN>                return;</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            questions.forEach(question =&gt; {</span></p>

<p class=MsoNormal><span lang=EN>                const questionCard =
createQuestionManagementCard(question);</span></p>

<p class=MsoNormal><span lang=EN>               
questionsList.appendChild(questionCard);</span></p>

<p class=MsoNormal><span lang=EN>            });</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function
createQuestionManagementCard(question) {</span></p>

<p class=MsoNormal><span lang=EN>            const card = document.createElement('div');</span></p>

<p class=MsoNormal><span lang=EN>            card.className = 'bg-gray-50
rounded-lg p-6';</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            const totalAnswers =
question.answers.length;</span></p>

<p class=MsoNormal><span lang=EN>            const correctAnswers =
question.answers.filter(a =&gt; a.answer === question.correctAnswer).length;</span></p>

<p class=MsoNormal><span lang=EN>            const correctPercentage =
totalAnswers &gt; 0 ? Math.round((correctAnswers / totalAnswers) * 100) : 0;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            card.innerHTML = `</span></p>

<p class=MsoNormal><span lang=EN>                &lt;div class=&quot;flex
justify-between items-start mb-4&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;flex-1&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;h4
class=&quot;font-semibold text-gray-800
mb-2&quot;&gt;${question.question}&lt;/h4&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;grid grid-cols-2 gap-2 text-sm&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;div&gt;A.
${question.options.A}&lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;div&gt;B.
${question.options.B}&lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;div&gt;C.
${question.options.C}&lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;div&gt;D.
${question.options.D}&lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;mt-2 text-sm text-green-600&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
&lt;strong&gt;คำตอบที่ถูกต้อง: ${question.correctAnswer}&lt;/strong&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;ml-4
text-right&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div
class=&quot;text-sm text-gray-600 mb-2&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
ตอบทั้งหมด: ${totalAnswers} คน&lt;br&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                           
ตอบถูก: ${correctPercentage}%</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;div class=&quot;flex
space-x-2&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;editQuestion(${question.id})&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                   
class=&quot;bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm
transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                &lt;i
class=&quot;fas fa-edit&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;button
onclick=&quot;deleteQuestion(${question.id})&quot; </span></p>

<p class=MsoNormal><span lang=EN>                                   
class=&quot;bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition-colors&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN>                                &lt;i
class=&quot;fas fa-trash&quot;&gt;&lt;/i&gt;</span></p>

<p class=MsoNormal><span lang=EN>                            &lt;/button&gt;</span></p>

<p class=MsoNormal><span lang=EN>                        &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                </span></p>

<p class=MsoNormal><span lang=EN>                ${question.explanation ? `</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;div class=&quot;mt-3
p-3 bg-blue-50 rounded text-sm&quot;&gt;</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>                       
&lt;strong&gt;คำอธิบาย:&lt;/strong&gt; ${question.explanation}</span></p>

<p class=MsoNormal><span lang=EN>                    &lt;/div&gt;</span></p>

<p class=MsoNormal><span lang=EN>                ` : ''}</span></p>

<p class=MsoNormal><span lang=EN>            `;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            return card;</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function addQuestion(questionText,
options, correctAnswer, explanation) {</span></p>

<p class=MsoNormal><span lang=EN>            const newQuestion = {</span></p>

<p class=MsoNormal><span lang=EN>                id: Date.now(),</span></p>

<p class=MsoNormal><span lang=EN>                question: questionText,</span></p>

<p class=MsoNormal><span lang=EN>                options: options,</span></p>

<p class=MsoNormal><span lang=EN>                correctAnswer: correctAnswer,</span></p>

<p class=MsoNormal><span lang=EN>                explanation: explanation,</span></p>

<p class=MsoNormal><span lang=EN>                answers: [],</span></p>

<p class=MsoNormal><span lang=EN>                createdAt: new
Date().toISOString()</span></p>

<p class=MsoNormal><span lang=EN>            };</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            questions.push(newQuestion);</span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN>            loadQuestionsForManagement();</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification('เพิ่มคำถามสำเร็จ!');</span></p>

<p class=MsoNormal><span lang=EN>            closeModal('addQuestionModal');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function editQuestion(id) {</span></p>

<p class=MsoNormal><span lang=EN>            const question = questions.find(q
=&gt; q.id === id);</span></p>

<p class=MsoNormal><span lang=EN>            if (!question) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
document.getElementById('questionModalTitle').textContent = 'แก้ไขคำถาม';</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('questionText').value = question.question;</span></p>

<p class=MsoNormal><span lang=EN>            document.getElementById('optionA').value
= question.options.A;</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('optionB').value = question.options.B;</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('optionC').value = question.options.C;</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('optionD').value = question.options.D;</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('correctAnswer').value = question.correctAnswer;</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('explanation').value = question.explanation || '';</span></p>

<p class=MsoNormal><span lang=EN>            document.getElementById('questionForm').dataset.editId
= id;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('addQuestionModal').classList.remove('hidden');</span></p>

<p class=MsoNormal><span lang=EN>           
document.getElementById('addQuestionModal').classList.add('flex');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function updateQuestion(id,
questionText, options, correctAnswer, explanation) {</span></p>

<p class=MsoNormal><span lang=EN>            const question = questions.find(q
=&gt; q.id === id);</span></p>

<p class=MsoNormal><span lang=EN>            if (!question) return;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            question.question = questionText;</span></p>

<p class=MsoNormal><span lang=EN>            question.options = options;</span></p>

<p class=MsoNormal><span lang=EN>            question.correctAnswer =
correctAnswer;</span></p>

<p class=MsoNormal><span lang=EN>            question.explanation =
explanation;</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            saveData();</span></p>

<p class=MsoNormal><span lang=EN>            loadQuestionsForManagement();</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
showNotification('แก้ไขคำถามสำเร็จ!');</span></p>

<p class=MsoNormal><span lang=EN>            closeModal('addQuestionModal');</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        function deleteQuestion(id) {</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>           
if (confirm('คุณแน่ใจหรือไม่ที่จะลบคำถามนี้?')) {</span></p>

<p class=MsoNormal><span lang=EN>                questions = questions.filter(q
=&gt; q.id !== id);</span></p>

<p class=MsoNormal><span lang=EN>                saveData();</span></p>

<p class=MsoNormal><span lang=EN>                loadQuestionsForManagement();</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial Unicode MS"'>               
showNotification('ลบคำถามแล้ว');</span></p>

<p class=MsoNormal><span lang=EN>            }</span></p>

<p class=MsoNormal><span lang=EN>        }</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN>        // Initialize the application</span></p>

<p class=MsoNormal><span lang=EN>       
document.addEventListener('DOMContentLoaded', function() {</span></p>

<p class=MsoNormal><span lang=EN>            initializeData();</span></p>

<p class=MsoNormal><span lang=EN>            syncData(); // Sync data on load</span></p>

<p class=MsoNormal><span lang=EN>            updateUI();</span></p>

<p class=MsoNormal><span lang=EN>            showHome();</span></p>

<p class=MsoNormal><span lang=EN>            loadTopNotebooks();</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Listen for storage changes
(sync across tabs)</span></p>

<p class=MsoNormal><span lang=EN>            window.addEventListener('storage',
function(e) {</span></p>

<p class=MsoNormal><span lang=EN>                if (e.key === 'cloudData') {</span></p>

<p class=MsoNormal><span lang=EN>                    syncData();</span></p>

<p class=MsoNormal><span lang=EN>                }</span></p>

<p class=MsoNormal><span lang=EN>            });</span></p>

<p class=MsoNormal><span lang=EN>            </span></p>

<p class=MsoNormal><span lang=EN>            // Auto-sync every 30 seconds</span></p>

<p class=MsoNormal><span lang=EN>            setInterval(syncData, 30000);</span></p>

<p class=MsoNormal><span lang=EN>        });</span></p>

<p class=MsoNormal><span lang=EN>    &lt;/script&gt;</span></p>

<p class=MsoNormal><span lang=EN>&lt;script&gt;(function(){function c(){var
b=a.contentDocument||a.contentWindow.document;if(b){var
d=b.createElement('script');d.innerHTML=&quot;window.__CF$cv$params={r:'968e8d7f630be60e',t:'MTc1NDE0Nzk1OC4wMDAwMDA='};var
a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);&quot;;b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var
a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else
if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var
e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&amp;&amp;(document.onreadystatechange=e,c())}}}})();&lt;/script&gt;&lt;/body&gt;</span></p>

<p class=MsoNormal><span lang=EN>&lt;/html&gt;</span></p>

<p class=MsoNormal><span lang=EN>&nbsp;</span></p>

</div>

</body>

</html>
